<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Module 1 Separating data recording and analysis | Improving the Reproducibility of Experimental Data Recording and Pre-Processing</title>
<meta name="author" content="Brooke Anderson, Michael Lyons, Mercedes Gonzalez-Juarrero, Marcela Henao-Tamayo, Gregory Robertson">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Module 1 Separating data recording and analysis | Improving the Reproducibility of Experimental Data Recording and Pre-Processing">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Module 1 Separating data recording and analysis | Improving the Reproducibility of Experimental Data Recording and Pre-Processing">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<meta name="description" content="Do you use spreadsheets within your scientific work? If so, you’re not alone. In fact, studies have surveyed scientists about their work practices, and they’ve found that spreadsheets are a common...">
<meta property="og:description" content="Do you use spreadsheets within your scientific work? If so, you’re not alone. In fact, studies have surveyed scientists about their work practices, and they’ve found that spreadsheets are a common...">
<meta name="twitter:description" content="Do you use spreadsheets within your scientific work? If so, you’re not alone. In fact, studies have surveyed scientists about their work practices, and they’ve found that spreadsheets are a common...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Improving the Reproducibility of Experimental Data Recording and Pre-Processing</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview of these modules</a></li>
<li class="book-part">Experimental Data Recording</li>
<li><a class="active" href="module1.html"><span class="header-section-number">1</span> Separating data recording and analysis</a></li>
<li><a class="" href="module2.html"><span class="header-section-number">2</span> Principles and power of structured data formats</a></li>
<li><a class="" href="module3.html"><span class="header-section-number">3</span> The “tidy” data format</a></li>
<li><a class="" href="module4.html"><span class="header-section-number">4</span> Designing templates for “tidy” data collection</a></li>
<li><a class="" href="module5.html"><span class="header-section-number">5</span> Example: Creating a template for “tidy” data collection</a></li>
<li><a class="" href="module6.html"><span class="header-section-number">6</span> Organizing project files</a></li>
<li><a class="" href="module7.html"><span class="header-section-number">7</span> Creating project directory templates</a></li>
<li><a class="" href="module8.html"><span class="header-section-number">8</span> Example: Creating a project template</a></li>
<li><a class="" href="module9.html"><span class="header-section-number">9</span> Harnessing version control for transparent data recording</a></li>
<li><a class="" href="module10.html"><span class="header-section-number">10</span> Enhance the reproducibility of collaborative research with version control platforms</a></li>
<li><a class="" href="module11.html"><span class="header-section-number">11</span> Using Git and GitHub to implement version control</a></li>
<li class="book-part">Experimental Data Pre-processing</li>
<li><a class="" href="module12.html"><span class="header-section-number">12</span> Principles of pre-processing experimental data</a></li>
<li><a class="" href="module13.html"><span class="header-section-number">13</span> Selecting software options for pre-processing</a></li>
<li><a class="" href="module14.html"><span class="header-section-number">14</span> Introduction to scripted data pre-processing in R</a></li>
<li><a class="" href="module15.html"><span class="header-section-number">15</span> Tips for improving reproducibility when writing R scripts</a></li>
<li><a class="" href="module16.html"><span class="header-section-number">16</span> Simplify scripted pre-processing through R’s “tidyverse” tools</a></li>
<li><a class="" href="module17.html"><span class="header-section-number">17</span> Complex data types in experimental data pre-processing</a></li>
<li><a class="" href="module18.html"><span class="header-section-number">18</span> Introduction to reproducible data pre-processing protocols</a></li>
<li><a class="" href="module19.html"><span class="header-section-number">19</span> RMarkdown for creating reproducible data pre-processing protocols</a></li>
<li><a class="" href="module20.html"><span class="header-section-number">20</span> Example: Creating a reproducible data pre-processing protocol</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/geanders/improve_repro">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="module1" class="section level1" number="1">
<h1>
<span class="header-section-number">Module 1</span> Separating data recording and analysis<a class="anchor" aria-label="anchor" href="#module1"><i class="fas fa-link"></i></a>
</h1>
<p>Do you use spreadsheets within your scientific work? If so, you’re not alone. In
fact, studies have surveyed scientists about their work practices, and they’ve
found that spreadsheets are a common tool. Examples include surveys of over 250
biomedical researchers at the University of Washington,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Nicholas R Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis: Needs and Barriers,”&lt;/span&gt; &lt;em&gt;Journal of the American Medical Informatics Association&lt;/em&gt; 14, no. 4 (2007): 478–88.&lt;/p&gt;"><sup>6</sup></a></span>
and of neuroscience researchers at the University of Newcastle. In both these
studies, most respondents reported that they used spreadsheets and other
general-purpose software in their research.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ghada AlTarawneh and Simon Thorne, &lt;span&gt;“A Pilot Study Exploring Spreadsheet Risk in Scientific Research,”&lt;/span&gt; &lt;em&gt;arXiv Preprint arXiv:1703.09785&lt;/em&gt;, 2017.&lt;/p&gt;"><sup>7</sup></a></span> A working
group on bioinformatics and data-intensive science similarly found spreadsheets
were the most common tool used across attendees.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Roger Barga et al., &lt;span&gt;“Bioinformatics and Data-Intensive Scientific Discovery in the Beginning of the 21st Century,”&lt;/span&gt; &lt;em&gt;Omics: A Journal of Integrative Biology&lt;/em&gt; 15, no. 4 (2011): 199–201.&lt;/p&gt;"><sup>8</sup></a></span></p>
<p>These software tools, such as Microsoft Excel or Google Sheets, provide for
manual or automated entry of data into rows and columns of cells. Standard or
custom formulas and other operations can be applied to the cells, and are
commonly used to reformat or clean the data, calculate various statistics, and
to generate simple plots; all of which are embedded as additional data entries
and programming elements within the spreadsheet. While these tools greatly
improved the paper worksheets on which they were originally based,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Martin Campbell-Kelly, &lt;span&gt;“Number Crunching Without Programming: The Evolution of Spreadsheet Usability,”&lt;/span&gt; &lt;em&gt;IEEE Annals of the History of Computing&lt;/em&gt; 29, no. 3 (2007): 6–19.&lt;/p&gt;"><sup>9</sup></a></span> this all-in-one practice impedes the transparency and
reproducibility of both recording and analysis of the large and complex data
sets that are routinely generated in life science experiments.</p>
<p>To improve the computational reproducibility of a research project, it is
critical for biomedical researchers to learn the importance of maintaining
recorded experimental data as “read-only” files, separating data recording from
any data pre-processing or data analysis steps.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Broman and Woo, &lt;span&gt;“Data Organization in Spreadsheets”&lt;/span&gt;; Marwick, Boettiger, and Mullen, &lt;span&gt;“Packaging Data Analytical Work Reproducibly Using &lt;span&gt;R&lt;/span&gt; (and Friends).”&lt;/span&gt;&lt;/p&gt;"><sup>10</sup></a></span></p>
<p>In this module, we’ll talk about why spreadsheets are so popular, as well
as some of their features that are beneficial for researchers. However, there
are also many problems they can introduce, particularly when spreadsheets are
used in a way that combines data collection with data pre-processing and analysis.
We’ll walk through some of these problems, and in later modules we’ll walk you
through alternatives, where spreadsheets are limited to recording data (if they’re
used at all), while steps of pre-processing and analysis are done with other
tools.</p>
<p><strong>Objectives.</strong> After this module, the trainee will be able to:</p>
<ul>
<li>Explain why spreadsheets are a popular tool among scientists</li>
<li>Explain the difference between data recording and data analysis</li>
<li>Understand why collecting data on spreadsheets with embedded formulas impedes
reproducibility</li>
<li>Compare ways that spreadsheets can be used as a solid research tool
versus other ways their use can be problematic</li>
<li>Discuss downsides to using spreadsheets for data analysis in scientific
research</li>
</ul>
<div id="popularity-of-spreadsheets" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Popularity of spreadsheets<a class="anchor" aria-label="anchor" href="#popularity-of-spreadsheets"><i class="fas fa-link"></i></a>
</h2>
<p>All of us authors are old enough to remember when home computers were a novelty.
When you first got a computer in your home, it opened up all kinds of new powers.</p>
<p>For one of us, one particularly exciting piece of software was something called
<em>The Print Shop</em>. This software let you be an amateur graphic designer. You could
design things like signs and invitations. Because the printer paper at the time
was connected from one sheet to the next, with perforations between, you could
even make long banners. “Happy Birthday” banners, “Congratulations” banners,
“Welcome Home” banners: you could do it all. For someone who’d never had these
tools before, it was thrilling.</p>
<p>This was evidently how early spreadsheet software made business executives feel.
Before these programs, if an executive wanted to crunch some numbers, they’d
have to send a request to their accounting department. The initial spreadsheet
program (VisiCalc) disrupted this process. It allowed one person to quickly
apply and test different models or calculations on recorded data.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Steven Levy, &lt;span&gt;“A Spreadsheet Way of Knowledge,”&lt;/span&gt; &lt;em&gt;Harpers&lt;/em&gt; 269 (1984): 58–64.&lt;/p&gt;"><sup>11</sup></a></span> These spreadsheet programs allowed non-programmers to
engage with data, including data processing and analysis tasks, in a way that
previously required programming expertise.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>12</sup></a></span> With
spreadsheet programs an executive could just play with the numbers themselves.</p>
<p>Because an early target for spreadsheet programs was these business
executives, the programs were designed to be very simple and easy to use—just
one step up in complexity from crunching numbers on the back of an envelope.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Campbell-Kelly, &lt;span&gt;“Number Crunching Without Programming.”&lt;/span&gt;&lt;/p&gt;"><sup>13</sup></a></span>Spreadsheet programs in fact became so popular within
businesses that many attribute these programs with driving the uptake of
personal computers.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>14</sup></a></span></p>
<p>Spreadsheets have become so popular in part because so many people know how to
use them, at least in basic ways, and so many people have the software on their
computers that files can be shared with almost a guarantee that everyone will be
able to open the file on their own computer.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Felienne Hermans et al., &lt;span&gt;“Spreadsheets Are Code: An Overview of Software Engineering Approaches Applied to Spreadsheets,”&lt;/span&gt; in &lt;em&gt;2016 IEEE 23rd International Conference on Software Analysis, Evolution, and Reengineering (SANER)&lt;/em&gt;, vol. 5 (IEEE, 2016), 56–65.&lt;/p&gt;"><sup>15</sup></a></span>
Spreadsheets use the visual metaphore of a traditional gridded ledger sheet,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Levy, &lt;span&gt;“A Spreadsheet Way of Knowledge.”&lt;/span&gt;&lt;/p&gt;"><sup>16</sup></a></span> providing an interface that is easy for users to
immediately understand and for which they can easily create a mental map.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;David Birch, David Lyford-Smith, and Yike Guo, &lt;span&gt;“The Future of Spreadsheets in the Big Data Era,”&lt;/span&gt; &lt;em&gt;arXiv Preprint arXiv:1801.10231&lt;/em&gt;, 2018; Barga et al., &lt;span&gt;“Bioinformatics and Data-Intensive Scientific Discovery in the Beginning of the 21st Century.”&lt;/span&gt;&lt;/p&gt;"><sup>17</sup></a></span> This visually clear interface also means that
spreadsheets can be printed or incorporated into other documents “as-is”, as a
workable and understandable table of data values. In fact, some of the most
popular plug-in software packages for the early spreadsheet program Lotus 1-2-3
were programs for printing and publishing spreadsheets.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Campbell-Kelly, &lt;span&gt;“Number Crunching Without Programming.”&lt;/span&gt;&lt;/p&gt;"><sup>18</sup></a></span>
This “What You See Is What You Get” interface was a huge advance from previous
methods of data analysis for the first spreadsheet program, VisiCalc, providing
a “window to the data” that was accessible to business executives and others
without programming expertise.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Richard Creeth, &lt;span&gt;“Microcomputer Spreadsheets: Their Uses and Abuses,”&lt;/span&gt; &lt;em&gt;Journal of Accountancy (Pre-1986)&lt;/em&gt; 159, no. 6 (1985): 90.&lt;/p&gt;"><sup>19</sup></a></span> Several surveys of
researchers have found that spreadsheets were popular because of their
simplicity and ease-of-use.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis”&lt;/span&gt;; AlTarawneh and Thorne, &lt;span&gt;“A Pilot Study Exploring Spreadsheet Risk in Scientific Research”&lt;/span&gt;; Barga et al., &lt;span&gt;“Bioinformatics and Data-Intensive Scientific Discovery in the Beginning of the 21st Century.”&lt;/span&gt;&lt;/p&gt;"><sup>20</sup></a></span> By contrast, databases and scripted programming
languages can be perceived as requiring a cognitive load and lengthy training
that is not worth the investment when an easier tool is available.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code”&lt;/span&gt;; Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis”&lt;/span&gt;; Sahiti Myneni and Vimla L Patel, &lt;span&gt;“Organization of Biomedical Data for Collaborative Scientific Research: A Research Information Management System,”&lt;/span&gt; &lt;em&gt;International Journal of Information Management&lt;/em&gt; 30, no. 3 (2010): 256–64; Barga et al., &lt;span&gt;“Bioinformatics and Data-Intensive Scientific Discovery in the Beginning of the 21st Century”&lt;/span&gt;; Thodoros Topaloglou et al., &lt;span&gt;“Biological Data Management: Research, Practice and Opportunities,”&lt;/span&gt; in &lt;em&gt;Proceedings of the Thirtieth International Conference on Very Large Data Bases-Volume 30&lt;/em&gt; (VLDB Endowment, 2004), 1233–36.&lt;/p&gt;"><sup>21</sup></a></span></p>
<p>Software tools like The Print Shop and spreadsheet programs were perfectly
designed for amateurs to begin to do some of the things that otherwise required
outsourcing to a professional. They are fantastic tools for amateur exploration.
They make it fun to test out ideas.</p>
<p>However, these types of software tools are so easy and convenient to use that it
can be tempting to let them replace more solid, production-level tools. It’s
easy, in other words, to make them the <em>only</em> tool used to tackle a problem,
rather than just the <em>first</em> tool to use to explore a solution. These tools are
also often the cheapest option, either in monetary cost or in the time
investment to learn them. However, they often fail when they’re used as a
replacement for more solid options. This can be the case with spreadsheet
programs in biomedical research, where spreadsheets are often used not only as a
straightforward way to record data (for which they can be a very solid tool),
but also to develop complex pipelines that process and analyze the data once its
been collected.</p>
</div>
<div id="hazards-of-combining-recording-and-analysis" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Hazards of combining recording and analysis<a class="anchor" aria-label="anchor" href="#hazards-of-combining-recording-and-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>In some cases, researchers use spreadsheets solely to record data, as a simple
type of database.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Birch, Lyford-Smith, and Guo, &lt;span&gt;“The Future of Spreadsheets in the Big Data Era.”&lt;/span&gt;&lt;/p&gt;"><sup>22</sup></a></span> However, biomedical researchers often use
spreadsheets to both record and analyze experimental data.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis”&lt;/span&gt;; Broman and Woo, &lt;span&gt;“Data Organization in Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>23</sup></a></span> In this case, data processing and analysis is implemented
through the use of formulas and macros embedded within the spreadsheet.</p>
<p>When a spreadsheet has formulas or macros within it, the spreadsheet program
creates an internal record of how cells are connected through these formulas.
For example, say the value in a specific cell is converted from Fahrenheit to
Celsius to fill a second cell, and then that value is combined with other values
in a column to calculate the mean temperature across several observations. In
this case, the spreadsheet program has internally saved how the later cells
depend on the earlier ones. When you change the value recorded in a cell of a
spreadsheet, the spreadsheet program queries this record and only recalculates
the cells that depend on that cell. This process allows the program to quickly
“react” to any change in cell inputs, immediately providing an update to all
downstream calculations and analyses.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Levy, &lt;span&gt;“A Spreadsheet Way of Knowledge.”&lt;/span&gt;&lt;/p&gt;"><sup>24</sup></a></span> Since early in
their development, spreadsheet programs have also included <em>macros</em>, “a single
computer instruction that stands for a sequence of operations.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Creeth, &lt;span&gt;“Microcomputer Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>25</sup></a></span></p>
<p>There are some important downsides to using these tools within scientific
research to create spreadsheets that combine data recording with data analysis.
Those include:</p>
<ul>
<li>Raw data are often lost</li>
<li>Analysis steps are often opaque</li>
<li>There is a higher potential for errors in the analysis</li>
<li>There are better software tools available for data analysis</li>
<li>It will make it more difficult to collaborate with statisticians</li>
</ul>
<p>Let’s take a look at each of these.</p>
<div id="raw-data-often-lost" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> Raw data often lost<a class="anchor" aria-label="anchor" href="#raw-data-often-lost"><i class="fas fa-link"></i></a>
</h3>
<p>One of the key tenets of ensuring that research is computationally reproducible
is to always keep a copy of all raw data, as well as the steps taken to get from
the raw data to a cleaned version of the data through to the results of data
analysis. However, maintaining an easily accessible copy of all original raw data
for a project is a common problem among biomedical researchers,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Alyssa Goodman et al., &lt;span&gt;“Ten Simple Rules for the Care and Feeding of Scientific Data”&lt;/span&gt; (Public Library of Science, 2014).&lt;/p&gt;"><sup>26</sup></a></span> especially as team members move on from a laboratory group.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Myneni and Patel, &lt;span&gt;“Organization of Biomedical Data for Collaborative Scientific Research.”&lt;/span&gt;&lt;/p&gt;"><sup>27</sup></a></span> In fact, one study of
operational spreadsheets found:</p>
<blockquote>
<p>“The data used in most spreadsheets is undocumented and there is no practical
way to check it. Even the original developer would have difficulty checking the
data.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Stephen G Powell, Kenneth R Baker, and Barry Lawson, &lt;span&gt;“Errors in Operational Spreadsheets: A Review of the State of the Art,”&lt;/span&gt; in &lt;em&gt;2009 42nd Hawaii International Conference on System Sciences&lt;/em&gt; (IEEE, 2009), 1–8.&lt;/p&gt;"><sup>28</sup></a></span></p>
</blockquote>
<p>One thing that can contribute to this problem is the use of spreadsheets to
jointly record and analyze data. First, data in a spreadsheet is typically not
saved as “read-only”, so it is possible for it to be accidentally overwritten:
in situations where spreadsheets are shared among multiple users, original cell
values can easily be accidentally written over, and it may not be clear who last
changed a value, when it was changed, or why.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;AlTarawneh and Thorne, &lt;span&gt;“A Pilot Study Exploring Spreadsheet Risk in Scientific Research.”&lt;/span&gt;&lt;/p&gt;"><sup>29</sup></a></span> Further,
raw and processed data are combined in a spreadsheet, which makes it hard to
identify which data points within the spreadsheet make up the raw data and which
are the result of processing that raw data.</p>
<p>Another issue is that many spreadsheets use a proprietary format. In the
development of spreadsheet programs, this use of proprietary binary file formats
helped a software program keep users, increasing barriers for a user to switch
to a new program (since the new program wouldn’t be able to read their old
files).<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Campbell-Kelly, &lt;span&gt;“Number Crunching Without Programming.”&lt;/span&gt;&lt;/p&gt;"><sup>30</sup></a></span> However, this file format may be hard to open in
the future, as software changes and evolves;<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;William K Michener, &lt;span&gt;“Ten Simple Rules for Creating a Good Data Management Plan,”&lt;/span&gt; &lt;em&gt;PLoS Computational Biology&lt;/em&gt; 11, no. 10 (2015): e1004525.&lt;/p&gt;"><sup>31</sup></a></span> by comparison,
plain text files should be widely accessible through general purpose tools—a
text editor is a type of software available on all computers, for
example—regardless of changes to proprietary software like Microsoft Excel.</p>
</div>
<div id="analysis-steps-are-often-opaque" class="section level3" number="1.2.2">
<h3>
<span class="header-section-number">1.2.2</span> Analysis steps are often opaque<a class="anchor" aria-label="anchor" href="#analysis-steps-are-often-opaque"><i class="fas fa-link"></i></a>
</h3>
<p>To keep analysis steps clear—whether the calculation is being done in scripted
code or in spreadsheets or in pen-and-paper calculations—it is important to
document what is being done at each step and why.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Goodman et al., &lt;span&gt;“Ten Simple Rules for the Care and Feeding of Scientific Data.”&lt;/span&gt;&lt;/p&gt;"><sup>32</sup></a></span> Scripted
languages allow for code comments, which are written directly into the script
but not evaluated by the computer, and so can be used to document steps within
the code without changing the operation of the code. Further, the program file
itself often presents a linear, step-by-step view of the pipeline, stored
separated from the data.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Creeth, &lt;span&gt;“Microcomputer Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>33</sup></a></span> Calculations done
with pen-and-paper (e.g., in a laboratory notebook) can be annotated with text
to document the steps. Spreadsheets, on the other hand, are often poorly
documented, or documented in ways that are hard to keep track of.</p>
<p>Within spreadsheets, the logic and methods behind the pipeline of data
processing and analysis is often not documented, or only documented with cell
comments (hard to see as a whole) or in emails, not the spreadsheet file.
One study that investigated a large collection of spreadsheets found that most
do not include documentation explaining the logic or implementation of data
processing and analysis implemented within the spreadsheet.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code.”&lt;/span&gt;&lt;/p&gt;"><sup>34</sup></a></span> A survey of neuroscience researchers at a UK
institute found that about a third of respondents included no documentation
for spreadsheets used in their research laboratories.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;AlTarawneh and Thorne, &lt;span&gt;“A Pilot Study Exploring Spreadsheet Risk in Scientific Research.”&lt;/span&gt;&lt;/p&gt;"><sup>35</sup></a></span></p>
<p>When spreadsheet pipelines are documented, it is often through methods that are
hard to find and interpret later. One study of scientific researchers found
that, when research spreadsheets were documented, it was often through “cell
comments” added to specific cells in the spreadsheet, which can be hard to
interpret inclusively to understand the flow and logic of a spreadsheet as a
whole.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>36</sup></a></span></p>
<p>In some cases, teams use email chains, rather than the document itself, to
discuss and document functionality and changes in spreadsheets. They pass
versions of the spreadsheet file as attachments of emails discuss the
spreadsheet in the email body.</p>
<p>One research team investigated over 700,000 emails from employees of Enron that
were released during legal proceedings.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Felienne Hermans and Emerson Murphy-Hill, &lt;span&gt;“Enron’s Spreadsheets and Related Emails: A Dataset and Analysis,”&lt;/span&gt; in &lt;em&gt;2015 IEEE/ACM 37th IEEE International Conference on Software Engineering&lt;/em&gt;, vol. 2 (IEEE, 2015), 7–16.&lt;/p&gt;"><sup>37</sup></a></span> They specifically
investigated the spreadsheets attached to these emails (over 15,000
spreadsheets) and how teams discussed the spreadsheets within the emails
themselves . They found that the logic and methods of calculations within the
spreadsheets were often documented within the bodies of emails. This means that,
if someone needs to figure out why a step was taken or identify when an error
was introduced into a spreadsheet, they must dig through the chain of old emails
documenting that spreadsheet, rather than having the relevant documentation
within the spreadsheet’s own file.</p>
<p>Adding to this issue is that data processing and analysis pipelines for
spreadsheets are not carefully designed; instead, it’s more typically for
spreadsheet user to start by directly entering data and formulas without a clear
overall plan.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;AlTarawneh and Thorne, &lt;span&gt;“A Pilot Study Exploring Spreadsheet Risk in Scientific Research.”&lt;/span&gt;&lt;/p&gt;"><sup>38</sup></a></span> As a result, research spreadsheets are
often not designed to follow a common structure for the research field or for
the laboratory group.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis.”&lt;/span&gt;&lt;/p&gt;"><sup>39</sup></a></span></p>
<p>Another problem comes up because there may only be one person on the team who
fully understands the spreadsheet: the person who created the spreadsheet.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Myneni and Patel, &lt;span&gt;“Organization of Biomedical Data for Collaborative Scientific Research.”&lt;/span&gt;&lt;/p&gt;"><sup>40</sup></a></span> This is particularly common if the spreadsheet
includes complex macros or a complicated structure in the analysis pipeline.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Creeth, &lt;span&gt;“Microcomputer Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>41</sup></a></span> This practice creates a heavy dependence on the
person who created that spreadsheet anytime the data or results in that
spreadsheet need to be interpreted. This is particularly problematic in projects
where the spreadsheet will be shared for collaboration or adapted to be used in
a future project, as is often done in scientific research groups. In this case,
it can be hard to “onboard” new people to use the file, and much of the work and
knowledge about the spreadsheet can be lost when that person moves on from the
business or laboratory group.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.; Myneni and Patel, &lt;span&gt;“Organization of Biomedical Data for Collaborative Scientific Research.”&lt;/span&gt;&lt;/p&gt;"><sup>42</sup></a></span></p>
<p>If you share a spreadsheet with numerous and complex macros and formulas
included to clean and analyze the data, it can take an extensive amount of time,
and in some cases may be impossible, for the researcher you share it with to
decipher what is being done to get from the original data input in some cells to
the final results shown in others and in graphs. Further, if others can’t figure
out the steps being done through macros and formulas in a spreadsheet, they will
not be able to check it for problems in the logic of the overall analysis
pipeline or for errors in the specific formulas used within that pipeline. They
also will struggle to extend and adapt the spreadsheet to be used for other
projects. These problems come up not only when sharing with a collaborator, but
also when reviewing spreadsheets that you have previously created and used (as
many have noted, your most frequent collaborator will likely be “future you”).
In fact, one survey of biomedical researchers at the University of Washington
noted that,</p>
<blockquote>
<p>“The profusion of individually created spreadsheets containing overlapping and
inconsistently updated data created a great deal of confusion within some labs.
There was little consideration to future data exchange of submission
requirements at the time of publication.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis.”&lt;/span&gt;&lt;/p&gt;"><sup>43</sup></a></span></p>
</blockquote>
</div>
<div id="potential-for-errors" class="section level3" number="1.2.3">
<h3>
<span class="header-section-number">1.2.3</span> Potential for errors<a class="anchor" aria-label="anchor" href="#potential-for-errors"><i class="fas fa-link"></i></a>
</h3>
<p>Because spreadsheets often do a poor job of making the analysis steps
transparent, they can be prone to bugs in analysis. As one early article on
the history of spreadsheet programs notes:</p>
<blockquote>
<p>“People tend to forget that even the most elegantly crafted spreadsheet is a
house of cards, ready to collapse at the first erroneous assumption. The
spreadsheet that looks good but turns out to be tragically wrong is becoming
a familiar phenomenon.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Levy, &lt;span&gt;“A Spreadsheet Way of Knowledge.”&lt;/span&gt;&lt;/p&gt;"><sup>44</sup></a></span></p>
</blockquote>
<p>Indeed, previous studies have found that errors are very common within
spreadsheets.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code.”&lt;/span&gt;&lt;/p&gt;"><sup>45</sup></a></span> For example, one study of 50
operational spreadsheets found that about 90% contained at least one error.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Powell, Baker, and Lawson, &lt;span&gt;“Errors in Operational Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>46</sup></a></span></p>
<p>In part, it is easier to make errors in spreadsheets and harder to catch errors
in later work with a spreadsheet because the formulas and connections between
cells aren’t visible when you look at the spreadsheet—they’re behind the
scenes.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Birch, Lyford-Smith, and Guo, &lt;span&gt;“The Future of Spreadsheets in the Big Data Era.”&lt;/span&gt;&lt;/p&gt;"><sup>47</sup></a></span> This makes it hard to get a clear and complete
view of the pipeline of analytic steps in data processing and analysis within a
spreadsheet, or to discern how cells are connected within and across sheets of
the spreadsheet.</p>
<p>Some characteristics of spreadsheets may heighten chances for errors. These
include high conditional complexity, which can result from lots of branching of
data flow through if / else structures, as well as formulas that depend on a
large number of cells or that incorporate many functions.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code.”&lt;/span&gt;&lt;/p&gt;"><sup>48</sup></a></span> Following the logical chain of spreadsheet formulas
can be particularly difficult when several calculations are chained in a row.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans and Murphy-Hill, &lt;span&gt;“Enron’s Spreadsheets and Related Emails.”&lt;/span&gt;&lt;/p&gt;"><sup>49</sup></a></span> In some cases, if you are trying to figure out very long
chains of dependent formulas across spreadsheet cells, you may even have to
sketch out by hand the flow of information through the spreadsheet to understand
what’s going on.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Bonnie A Nardi and James R Miller, &lt;span&gt;“The Spreadsheet Interface: A Basis for End User Programming,”&lt;/span&gt; in &lt;em&gt;Proceedings of the IFIP TC13 Third Interational Conference on Human-Computer Interaction&lt;/em&gt; (North-Holland Publishing Co., 1990), 977–83.&lt;/p&gt;"><sup>50</sup></a></span> When a spreadsheet uses macros, it can
also make it particularly hard to figure out the steps of an analysis and to
diagnose and fix any bugs in those steps.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;JC Nash, &lt;span&gt;“Spreadsheets in Statistical Practice—Another Look,”&lt;/span&gt; &lt;em&gt;The American Statistician&lt;/em&gt; 60, no. 3 (2006): 287–89; Creeth, &lt;span&gt;“Microcomputer Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>51</sup></a></span> One study investigated how spreadsheets are used in
practice and noted that, “Many spreadsheets are so chaotically designed that
auditing (especially of a few formulas) is extremely difficult or impossible.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Powell, Baker, and Lawson, &lt;span&gt;“Errors in Operational Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>52</sup></a></span></p>
<p>In some cases, formula dependencies might span across different sheets of a
spreadsheet file. These cross-sheet dependencies can make the analysis steps
even more opaque,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code.”&lt;/span&gt;&lt;/p&gt;"><sup>53</sup></a></span> as a change in the cell value of
one sheet might not be immediately visible as a change in another cell on that
sheet (the same is true for spreadsheets so large that all the cells in a sheet
are not concurrently visible on the screen). Other common sources of errors
included incorrect references to cells inside formulas and incorrect use of
formulas<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Powell, Baker, and Lawson, &lt;span&gt;“Errors in Operational Spreadsheets.”&lt;/span&gt;&lt;/p&gt;"><sup>54</sup></a></span> or errors introduced through the common practice of
copying and pasting when developing spreadsheets.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code.”&lt;/span&gt;&lt;/p&gt;"><sup>55</sup></a></span></p>
<p>There are methods that have been brought from more traditional programming work
into spreadsheet programming to try to help limit errors, including a tool
called <em>assertions</em> that allows users to validate data or test logic within their
spreadsheets.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>56</sup></a></span> However, these are often not
implemented, in part perhaps because many spreadsheet users see themselves as
“end-users”, creating spreadsheets for their own personal use rather than as
something robust to future use by others, and so don’t seek out strategies
adopted by programmers when creating stable tools for others to use.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>57</sup></a></span> In practice, though, a spreadsheet is often used
much longer, and by more people, than originally intended. From early in the
history of spreadsheet programs, users have shared spreadsheet files with
interesting functionality with other users,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Levy, &lt;span&gt;“A Spreadsheet Way of Knowledge.”&lt;/span&gt;&lt;/p&gt;"><sup>58</sup></a></span> and the
lifespan of a spreadsheet can extend and extend—a spreadsheet created by one
user for their own personal use can end up being used and modified by that
person or others for years.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Hermans et al., &lt;span&gt;“Spreadsheets Are Code.”&lt;/span&gt;&lt;/p&gt;"><sup>59</sup></a></span></p>
</div>
<div id="better-software-tools-are-available" class="section level3" number="1.2.4">
<h3>
<span class="header-section-number">1.2.4</span> Better software tools are available<a class="anchor" aria-label="anchor" href="#better-software-tools-are-available"><i class="fas fa-link"></i></a>
</h3>
<p>While spreadsheets serve as a widely-used tool for data recording and analysis,
in many cases spreadsheets programs are poorly suited to pre-process and analyze
scientific data compared to other programs. As tools and interfaces continue to
develop that make other software more user-friendly to those new to programming,
scientists may want to reevaluate the costs and benefits, in terms of both time
required for training and aptness of tools, of spreadsheet programs compared to
scripted programming languages like R and Python.</p>
<p>Several problems have been identified with spreadsheet programs in the context
of recording and, especially, analyzing scientific data. First, some statistical
methods may be inferior to those available in other statistical programming
language. Many statistical operations require computations that cannot be
perfectly achieved with a computer, since the computer must ultimately solve
many mathematical problems using numerical approximations (e.g., calculus). The
choice of the algorithms used for these approximations heavily influence how
closely a result approximates the true answer. Since the most popular
spreadsheet program (Excel) is closed-source, it is hard to identify and
diagnose such problems, and there is likely less of an incentive for problems in
statistical methodology to be fixed (rather than using development time and
funds to increase easier-to-see functionality in the program).</p>
<p>A series of papers examined the quality of statistical methods in several
statistical software programs, including Excel, starting in the 1990s.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Bruce D McCullough and Berry Wilson, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 97,”&lt;/span&gt; &lt;em&gt;Computational Statistics &amp;amp; Data Analysis&lt;/em&gt; 31, no. 1 (1999): 27–37; Bruce D McCullough, &lt;span&gt;“Assessing the Reliability of Statistical Software: Part II,”&lt;/span&gt; &lt;em&gt;The American Statistician&lt;/em&gt; 53, no. 2 (1999): 149–59; B D McCullough and Berry Wilson, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 2000 and Excel XP,”&lt;/span&gt; &lt;em&gt;Computational Statistics &amp;amp; Data Analysis&lt;/em&gt; 40, no. 4 (2002): 713–21; Bruce D McCullough and Berry Wilson, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 2003,”&lt;/span&gt; &lt;em&gt;Computational Statistics &amp;amp; Data Analysis&lt;/em&gt; 49, no. 4 (2005): 1244–52; Bruce D McCullough and David A Heiser, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 2007,”&lt;/span&gt; &lt;em&gt;Computational Statistics &amp;amp; Data Analysis&lt;/em&gt; 52, no. 10 (2008): 4570–78; Guy Mélard, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 2010,”&lt;/span&gt; &lt;em&gt;Computational Statistics&lt;/em&gt; 29, no. 5 (2014): 1095–1128.&lt;/p&gt;"><sup>60</sup></a></span> In the
earliest studies, they found some concerns across all programs considered.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;McCullough and Wilson, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 97”&lt;/span&gt;; McCullough, &lt;span&gt;“Assessing the Reliability of Statistical Software.”&lt;/span&gt;&lt;/p&gt;"><sup>61</sup></a></span> One of the biggest
concerns, however, was that there was little evidence over the years that the
identified problems in Excel were resolved, or at least improved, over time.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;BD McCullough, &lt;span&gt;“Does Microsoft Fix Errors in Excel?”&lt;/span&gt; in &lt;em&gt;Proceedings of the 2001 Joint Statistical Meetings&lt;/em&gt;, 2001; McCullough and Heiser, &lt;span&gt;“On the Accuracy of Statistical Procedures in Microsoft Excel 2007.”&lt;/span&gt;&lt;/p&gt;"><sup>62</sup></a></span> The authors note that there may
be little incentive for checking and fixing problems with algorithms for
statistical approximation in closed-source software like Excel, where sales
might depend more on the more immediately evident functionality in the software,
while problems with statistical algorithms might be less evident to potential
users.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;McCullough, &lt;span&gt;“Does Microsoft Fix Errors in Excel?”&lt;/span&gt;&lt;/p&gt;"><sup>63</sup></a></span></p>
<p>Open-source software, on the other hand, offers pathways for identifying and fixing
any problems in the software, including for statistical algorithms and methods
implemented in the software’s code. Since the full source code is available, researchers
can closely inspect the algorithms being used and compare them to the latest
knowledge in statistical computing methodology. Further, if an inferior algorithm is in
use, most open-source software licenses allow a user to adapt and extend the software,
including to implement better statistical algorithms.</p>
<p>Another problem is that spreadsheet programs can include automated functionality
that’s meant to make something easier for most users, but that might invisibly
create some problems. A critical problem, for example, has been identified when
using Excel for genomics data. When Excel encounters a cell value in a format
that seems like it could be a date (e.g., “Mar-3-06”), it will try to convert
that cell to a “date” class. Many software programs save date as this special
“date” format, where it is printed and visually appears in a format like
“3-Mar-06” but is saved internally by the program as a number (for Microsoft
Excel, the number of days since January 1, 1900).<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Frans Willekens, &lt;span&gt;“Chronological Objects in Demographic Research,”&lt;/span&gt; &lt;em&gt;Demographic Research&lt;/em&gt; 28 (2013): 649–80.&lt;/p&gt;"><sup>64</sup></a></span>
By doing this, the software can more easily undertake calculations with dates,
like calculating the number of days between two dates or which of two dates is
earlier. Bioinformatics researchers at the National Institutes of Health found
that Excel was doing this type of automatic and irreversible date conversion for
30 gene names, including “MAR3” and “APR-4”, resulting in these gene names being
lost for further analysis.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Barry R Zeeberg et al., &lt;span&gt;“Mistaken Identifiers: Gene Name Errors Can Be Introduced Inadvertently When Using &lt;span&gt;Excel&lt;/span&gt; in Bioinformatics,”&lt;/span&gt; &lt;em&gt;BMC Bioinformatics&lt;/em&gt; 5, no. 1 (2004): 80.&lt;/p&gt;"><sup>65</sup></a></span></p>
<p>Avoiding this automatic date conversion required specifying that columns
susceptible to these problems, including columns of gene names, should
be retained in a “text” class in Excel’s file import process. While this
problem was originally identified and published in 2004,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>66</sup></a></span>
along with tips to identify and avoid the problem, a study in 2016 found that
approximately a fifth of genomics papers investigated in a large-scale review
had gene name errors resulting from Excel automatic conversion, with the rate of
errors actually increasing over time.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Mark Ziemann, Yotam Eren, and Assam El-Osta, &lt;span&gt;“Gene Name Errors Are Widespread in the Scientific Literature,”&lt;/span&gt; &lt;em&gt;Genome Biology&lt;/em&gt; 17, no. 1 (2016): 177.&lt;/p&gt;"><sup>67</sup></a></span></p>
<p>Other automatic conversion problems caused the lost of clone identifiers that
were composed of digits and the letter “E.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Zeeberg et al., &lt;span&gt;“Mistaken Identifiers”&lt;/span&gt;; Eric A Welsh et al., &lt;span&gt;“Escape Excel: A Tool for Preventing Gene Symbol and Accession Conversion Errors,”&lt;/span&gt; &lt;em&gt;PloS One&lt;/em&gt; 12, no. 9 (2017): e0185207.&lt;/p&gt;"><sup>68</sup></a></span> These were assumed to be expressing a number using scientific
notation and so automatically and irreversibly converted to a numeric class.
Further automatic conversion problems can be caused by cells that start with an
operator (e.g., “+ control”) or with leading zeros in a numeric identifier
(e.g., “007”).<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Welsh et al., &lt;span&gt;“Escape Excel.”&lt;/span&gt;&lt;/p&gt;"><sup>69</sup></a></span></p>
<p>Finally, spreadsheet programs can be limited as analysis needs become more
complex or large.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Topaloglou et al., &lt;span&gt;“Biological Data Management.”&lt;/span&gt;&lt;/p&gt;"><sup>70</sup></a></span> For example, spreadsheets can be
problematic when integrating or merging large, separate datasets.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Birch, Lyford-Smith, and Guo, &lt;span&gt;“The Future of Spreadsheets in the Big Data Era.”&lt;/span&gt;&lt;/p&gt;"><sup>71</sup></a></span> Further, while spreadsheet programs continue to expand in
their capacity for data, for very large datasets they continue to face limits
that may be reached in practical applications—<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>72</sup></a></span>until
recently, for example, Excel could not handle more than one million rows of data
per spreadsheet. Even when spreadsheets can handle larger data, their efficiency
in running data processing and analysis pipelines across large datasets can be
slow compared to code implemented with other programming languages.</p>
</div>
<div id="difficulty-collaborating-with-statisticians" class="section level3" number="1.2.5">
<h3>
<span class="header-section-number">1.2.5</span> Difficulty collaborating with statisticians<a class="anchor" aria-label="anchor" href="#difficulty-collaborating-with-statisticians"><i class="fas fa-link"></i></a>
</h3>
<p>Modern biomedical researchers requires large teams, with statisticians and
bioinformaticians often included, to enable sophisticated processing and
analysis of experimental data. However, the process of combining data recording
and analysis, especially through the use of spreadsheet programs, can create
barriers in working across disciplines. One group defined these issues as “data
friction” and “science friction”—the extra steps and work required at each
interface where data passes, for example, from a machine to analysis or from a
collaborator in one discipline to one in a separate discipline.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Paul N Edwards et al., &lt;span&gt;“Science Friction: Data, Metadata, and Collaboration,”&lt;/span&gt; &lt;em&gt;Social Studies of Science&lt;/em&gt; 41, no. 5 (2011): 667–90.&lt;/p&gt;"><sup>73</sup></a></span></p>
<p>When collaborating with statisticians or bioinformaticians, one of the key
sources of this “data friction” can result from the use of spreadsheets to
jointly record and analyze experiemental data. First, spreadsheets are easy to
print or copy into another format (e.g., PowerPoint presentation, Word
document), and so researchers often design spreadsheets to be immediately
visually appealing to viewers. For example, a spreadsheet might be designed to
include hierarchically organized headers (e.g., heading and subheading, some
within a cell merged across several columns), or to show the result of a
calculation at the bottom of a column of observations (e.g., “Total” in the last
cell of the column).<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ricardo Teixeira and Vasco Amaral, &lt;span&gt;“On the Emergence of Patterns for Spreadsheets Data Arrangements,”&lt;/span&gt; in &lt;em&gt;Federation of International Conferences on Software Technologies: Applications and Foundations&lt;/em&gt; (Springer, 2016), 333–45.&lt;/p&gt;"><sup>74</sup></a></span> Multiple separate small tables
might be included in the same sheet, with empty cells used for visual
separation, or use a “horizontal single entry” design , where the headers are in
the leftmost column rather than the top row.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ibid.&lt;/p&gt;"><sup>75</sup></a></span></p>
<p>These spreadsheet design choices make it much more difficult for the contents of
the spreadsheet to be read into other statistical programs. These types of data
require several extra steps in coding, in some cases fairly complex coding, with
regular expressions or logical rules needed to parse out the data and convert it
to the needed shape, before the statistical work can be done for the dataset.
This is a poor use of time for a collaborating statistician, especially if it
can be avoided through the design of the data recording template. Further, it
introduces many more chances for errors in cleaning the data.</p>
<p>Further, information embedded in formulas, macros, and extra formatting like
color or text boxes is lost when the spreadsheet file is input into other
programs. Spreadsheets allow users to use highlighting to represent information
(e.g., measurements for control animals shown in red, those for experiment
animals in blue) and to include information or documentation in text boxes. For
example, one survey study of biomedical researchers at the University of
Washington included this quote from a respondent: “I have one spreadsheet that
has all of my chromosomes … and then I’ve gone through and color coded it for
homozygosity and linkage.”<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Anderson et al., &lt;span&gt;“Issues in Biomedical Research Data Management and Analysis.”&lt;/span&gt;&lt;/p&gt;"><sup>76</sup></a></span> All the information encoded in
this sheet through color will be lost when the data from the spreadsheet is read
into another statistical program.</p>
</div>
</div>
<div id="approaches-to-separate-recording-and-analysis" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Approaches to separate recording and analysis<a class="anchor" aria-label="anchor" href="#approaches-to-separate-recording-and-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>In the remaining modules in this section, we will present and describe
techniques that can be used to limit or remove these problems. First, in the
next few modules, we will walk through techniques to design data recording
formats so that data is saved in a consistent format across experiments within a
laboratory group, and in a way that removes “data friction” for collaboration
with statisticians or later use in scripted code. These techniques can be
immediately used to design a better spreadsheet to be used solely for data
collection.</p>
<p>In later modules, we will discuss the use of project directories to coordinate
data recording and analysis steps within a directory, while using separate files
for data recording versus data processing and analysis. These more advanced
formats will enable the use of quality assurance / control measures like testing
of data entry and analysis functionality, better documentation of data analysis
pipelines, and easy use of version control to track projects and collaborate
transparently and with a recorded history.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="index.html">Overview of these modules</a></div>
<div class="next"><a href="module2.html"><span class="header-section-number">2</span> Principles and power of structured data formats</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#module1"><span class="header-section-number">1</span> Separating data recording and analysis</a></li>
<li><a class="nav-link" href="#popularity-of-spreadsheets"><span class="header-section-number">1.1</span> Popularity of spreadsheets</a></li>
<li>
<a class="nav-link" href="#hazards-of-combining-recording-and-analysis"><span class="header-section-number">1.2</span> Hazards of combining recording and analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#raw-data-often-lost"><span class="header-section-number">1.2.1</span> Raw data often lost</a></li>
<li><a class="nav-link" href="#analysis-steps-are-often-opaque"><span class="header-section-number">1.2.2</span> Analysis steps are often opaque</a></li>
<li><a class="nav-link" href="#potential-for-errors"><span class="header-section-number">1.2.3</span> Potential for errors</a></li>
<li><a class="nav-link" href="#better-software-tools-are-available"><span class="header-section-number">1.2.4</span> Better software tools are available</a></li>
<li><a class="nav-link" href="#difficulty-collaborating-with-statisticians"><span class="header-section-number">1.2.5</span> Difficulty collaborating with statisticians</a></li>
</ul>
</li>
<li><a class="nav-link" href="#approaches-to-separate-recording-and-analysis"><span class="header-section-number">1.3</span> Approaches to separate recording and analysis</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/geanders/improve_repro/blob/master/01-separating.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/geanders/improve_repro/edit/master/01-separating.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Improving the Reproducibility of Experimental Data Recording and Pre-Processing</strong>" was written by Brooke Anderson, Michael Lyons, Mercedes Gonzalez-Juarrero, Marcela Henao-Tamayo, Gregory Robertson. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
