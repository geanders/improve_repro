<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2.8 Example: Creating a ‘Project’ template | Improving the Reproducibility of Experimental Data Recording and Pre-Processing" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Online book with modules for improving the reproducibility of experimental data recording and preprocessing." />
<meta name="github-repo" content="rstudio/bookdown-demo" />

<meta name="author" content="Brooke Anderson, Michael Lyons, Mercedes Gonzalez-Juarrero, Marcela Henao-Tamayo, and Gregory Robertson" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Online book with modules for improving the reproducibility of experimental data recording and preprocessing.">

<title>2.8 Example: Creating a ‘Project’ template | Improving the Reproducibility of Experimental Data Recording and Pre-Processing</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#overview"><span class="toc-section-number">1</span> Overview</a></li>
<li><a href="2-experimental-data-recording.html#experimental-data-recording"><span class="toc-section-number">2</span> Experimental Data Recording</a></li>
<li><a href="3-experimental-data-preprocessing.html#experimental-data-preprocessing"><span class="toc-section-number">3</span> Experimental Data Preprocessing</a></li>
<li><a href="4-references.html#references"><span class="toc-section-number">4</span> References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="module8" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Example: Creating a ‘Project’ template</h2>
<p>We will walk through a real example, based on the experiences of one of our
Co-Is, of establishing the format for a research group’s ‘Project’ template,
creating that template using RStudio, and initializing a new research project
directory using the created template. This example will be from a
laboratory-based research group that studies the efficacy of tuberculosis drugs
in a murine model.</p>
<p><strong>Objectives.</strong> After this module, the trainee will be able to:</p>
<ul>
<li>Create a ‘Project’ template in RStudio to initialize consistently-formatted
‘Project’ directories</li>
<li>Initialize a new ‘Project’ directory using this template</li>
</ul>
<p>For this module, we’ll show how to create an R Project template to manage data
from the example set of studies that we described in module 2.7. As a reminder,
this example set of studies covers a group of studies to explore novel
treatments for tuberculosis. Each study investigates how mice that are
challenged with tuberculosis respond to different treatments, both in terms of
how well they handle the treatment (assessed by checking if their weight
decreases notably while on treatment) and also how well the treatment manages to
limit the growth of tuberculosis in the mouse’s lungs.</p>
<p>We will walk through the process of creating a project directory template that could
be used to manage and analyze data from any of the specific studies in this set of
studies. We’ll cover two ways that you could do this. The first is simpler—it involves
creating a basic file directory with the desired template files and file directory
structure and then copying this file directory every time you want to start a new
project for a study in this set of studies. The second way is a bit more complex and
time-consuming to set up, but has the benefit of providing a very nice interface for
members of your laboratory group to use when they start a new project. This second way
is to create a full R Project template that can be accessed from RStudio anytime you
create a new R Project. This type of template may not be worth the extra set-up time
for project types that your research group only uses rarely, but for types of projects
that your group conducts time and time again, it can be a powerful way to enforce a common
project directory structure, and this in turn will allow your group to create reusable
tools that work in coordination with this project structure.</p>
<div id="creating-and-using-a-basic-template" class="section level3" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Creating and using a basic template</h3>
<p>Let’s start by looking at the more basic way to create a project template. This involves
no fancy tools—in fact, it’s so straightforward that at first it might seem to simple
to be useful. For this basic approach, you will create an example file directory that
includes template files and that captures you desired project directory structure, and
then members of your group will copy and rename that template every time they start a
new project of that type.</p>
<p>Figure <a href="2.8-module8.html#fig:basicprojecttemplateuse">2.38</a> gives a basic walk-through of the
simple steps you’ll use to start a new project directory once you’ve created
this type of template. First, you will find the project directory template in
your computer’s file system, copy it to where you’d like to save the files for
the new project, and rename the directory to your new project’s name. At this
point, you can use RStudio to make this directory an RStudio Project. Next,
you’ll open the data collection template files and replace the placeholder
example data in the template (shown in red font) with the real data from your
study. The placeholder data can help you remember the format you should use to
record the real data. Finally, once you’ve recorded the data for the study or
experiment, you can open the example report template file. If you’ve designed
this report template well, it should run with the new data you’ve recorded to
create a report for the experiment. At this stage, you can add to the report
or customize it for the new project by changing the Rmarkdown file and re-rendering
it to update the report.</p>
<div class="figure fullwidth"><span style="display:block;" id="fig:basicprojecttemplateuse"></span>
<img src="figures/project_template_basic_use.png" alt="Steps in using a basic project directory template that you have created for a type of study or experiment." width="\textwidth"  />
<p class="caption marginnote shownote">
Figure 2.38: Steps in using a basic project directory template that you have created for a type of study or experiment.
</p>
</div>
<p>There are a few steps you’ll need to take to create this type of basic project directory
template:</p>
<ol style="list-style-type: decimal">
<li>List the data you typically collect or files you create for that type of study or experiment</li>
<li>Create template files for any data collection that is typical for that type of study
or experiment. Use example or placeholder data to create examples of those files.</li>
<li>Create a directory structure that divides the types of files into subdirectories of similar
types.</li>
<li>Create one or more templates of report files that access and report on the data in the
project template</li>
</ol>
<p>In modules [x], we showed how you can create tidy data collection templates to use to
collect data, and how these can be paired with reproducible reporting tools to separate
the steps of data collection and reporting (modules [x] go into much more depth on these
reproducible reporting tools). Once you have decided on the types of data that you will
usually collect for the type of study that this template is for, you can use that process
to create tidy data collection templates for each type of data.</p>
<p>In addition to the data that you record in the laboratory by hand, the type of study may
also typically have data that’s generated and recorded by laboratory equipment. For example,
the type of study may often include data collected from flow cytometry, to measure certain
cell populations in samples, or from mass spectometry, to measure levels of certain molecules.
For these data, the recording format will typically be determined by the equipment, and
so you won’t need to create data collection templates for the data. However, you should store
these data files in your project directory as well, where they are easy to access and integrate
with other data as you analyze the data for the study.</p>
<p>The recorded data files and the files that come directly from equipment can all be considered
raw data files. In addition, you may typically create some files with pre-processed data.
For example, if you have sequencing data [?], you may initially get large [what type] files
from the [what type] equipment. You may use a program like [what] to pre-process these files
to [do what]. In addition to saving the raw [what type] data files, you’ll also want to
save the processed data files in your project directory, since these are the files that you’ll
analyze and integrate with other data from the project.</p>
<p>Once you have determined the types of files that you’ll normally include in your
project, you can decide how to organize them into subdirectories in a project
file directory. As you do this, it will be helpful to have example or template
files for each file type. For data that you will record yourself, these can be
the templates that you developed to collect the data in a tidy format (modules
[x]), while for data from equipment, these can just be one or more example files
from the equipment that you have collected for a past project. Having these example files
will help you to develop a template project report that can input the type of data that
you typically collect for this type of project.</p>
<p>For the example set of studies for this module, there are a few types of data
that we plan to typically collect for each study. First, we will be recording
metadata for each experiment. This will include a study ID, as well as details
like the mouse strain that we used in that experiment, the route used to
administer the treatment, the treatments per week and total weeks of treatment,
the inoculum used for the challenge, and so on. Second, we’ll be recording some
details about each experimental group that was tested. This includes the drug or
drugs that were tested, doses of each, and some exact details about the
treatment regimen for that group. Both of these types of data can be recorded at
the beginning of the study. Two other types of data will also be recorded, both
of them during the study rather than at the start. The first is weights of the
mice each week. These weights will be recorded for each treatment group each
week of treatment, to help see if there are drugs that are poorly tolerated by
the mice (which can show up through weight decreases in mice in that group). The
second is the bacterial load in the lungs of each mouse at the end of the
treatment period.</p>
<p>To create the project directory template for these studies, then, we’ll create
data collection templates for each of these types of data. We’ll create a
separate spreadsheet for each type of data, but we can group them into files if
we’d like. In our example, we created two files to store this type of data, one
for the metadata that are recorded at the start of the experiment (overall
experiment details and the details of each tested treatment) and one for the
data that are collected over the course of the experiment (mouse weights and
bacterial loads). Within each file, we’ve used separate sheets to record the
different types of data. This allows us to keep similar types of data together
in the same file, while having a tidy collection format for each specific type
of data. [Figure]</p>
<div class="figure fullwidth"><span style="display:block;" id="fig:projectdatacollection"></span>
<img src="figures/project_data_collection.png" alt="Data collection templates for the example project directory template. These templates were created in two files, one for metadata, which is saved in the main directory of the project, and one for data collected in the laboratory during the experiment, which is saved in the 'data' subdirectory. Each file is saved as a spreadsheet file, with two sheets in each file to store different types of data." width="\textwidth"  />
<p class="caption marginnote shownote">
Figure 2.39: Data collection templates for the example project directory template. These templates were created in two files, one for metadata, which is saved in the main directory of the project, and one for data collected in the laboratory during the experiment, which is saved in the ‘data’ subdirectory. Each file is saved as a spreadsheet file, with two sheets in each file to store different types of data.
</p>
</div>
<p>All of these data collection files are designed using the principles of tidy data
collection (modules [x]). This will ensure that it will be easy to read these
recorded data in a programming language like R for analysis and visualization.
Specifically, when we designed these template files, we thought a lot about
things like using a two-dimensional structure (one row of header names and then
values within each of the columns), using column names that would be easy for
a programming language to parse (e.g., no special characters or spaces in the
column names), and so on.</p>
<p>Now that we have these data collection templates for this type of study, we can
decide how to organize the project directory into subdirectories with the different
types of data. In this case, we’ll use a simple structure. We’ll save the metadata
file in the top level of the project directory, since it provides metadata on the
project as a whole. For the data that are collected during the experiment, we’ll
move that data collection file into a subdirectory called “data,” with its own
subdirectory for “recorded_data” (indicating that we recorded it by hand in the
laboratory). If you had other types of data, you could create other subdirectories
for each type. For example, you could have a “flow_data” subdirectory for data
collected through flow cytometry.</p>
<p>If you had raw data that required pre-processing, you could create
subdirectories both for the raw data and for the processed data that result from
pre-processing steps. For example, if you had data from [RNA sequencing?], you might
have [initial files] and [processed files], as well as a [bash?] script that you used
to generate the processed files from the initial raw data. You could create a directory
called “raw_data” to use to store both the initial raw data and the script used to
process that data, then a “rna_seq_data” subdirectory in the “data” subdirectory to
store the smaller pre-processed files.</p>
<div class="figure"><span style="display:block;" id="fig:projecttemplatecomplex"></span>
<p class="caption marginnote shownote">
Figure 2.40: Example of a more complex project directory structure that could be created, with directories added to store data collected through flow cytometry and single cell RNA sequencing.
</p>
<img src="figures/project_template_morecomplex.png" alt="Example of a more complex project directory structure that could be created, with directories added to store data collected through flow cytometry and single cell RNA sequencing." width="\textwidth"  />
</div>
<p>With the previous steps, you will have determined the types of files you normally
have for this type of study, as well as structured the project directory to organize
these files. The next step is to create a template report. You can create this using
tools for reproducible reports—in R, a key tool for this is RMarkdown. Here, we’ll
cover using this tool for creating a report briefly, but there are many more details
in modules [x].</p>
<p>Briefly, RMarkdown allows you to include both code and text meant for humans within
a single, plain text document. This document can then be rendered, a process that
executes the code and formats the text meant for humans, producing a document in an
easy-to-read format like Word or PDF. When it comes to project directories, it turns
out that you can use the directory structure in your favor when you create these
reports.</p>
<p>There are functions in R, for example, that will allow you to print all the
files in a specified subdirectory. Say that you have several flow cytometry files
in a subdirectory of the “data” subdirectory called “flow_data.” You could use this
function in R to create a list of all the files in that subdirectory, and then you
can run other functions to do the same operations on all of those files.</p>
<p>When you create a project directory template, we recommend that you create a
subdirectory named something like “reports” to use to store any Rmarkdown report
files for the project. This organization will make it clear where you’ve stored your
reports in the project directory. You’ll be able to use file and directory pathnames
to access all the data in the project, so it will be easy to use the study’s data
in the report even if they’re in separate subdirectories. There’s only one tool
you’ll need to do this—you’ll need to learn how to use relative pathnames
within R code to access files in a different part of your project directory.</p>
<p>A pathname gives the directions to a file that is stored somewhere, for example
on your computer or a server. There are two ways to state a pathname—you can
state it as either an absolute pathname or a relative pathname. An absolute
pathname gives the directions to the file from the root directory of the
computer where it’s stored. In other words, it gives the directions starting
from the very earliest point in the file directory for that computer. A relative
pathname, on the other hand, gives the directions to the file from something
called the current working directory—that is, the directory that your current
program is currently operating from.</p>
<p>You have likely already used relative pathnames extensively. If you read in a file
to a statistical program like R or Python, if that file is in the current working
directory, you only have to give its file name to point the program to the file.
You may not have realized it, but in this case, you were using the simplest type of
relative pathname—since the file is already in your working directory, you
don’t need to give directions that move through different directories to get from
your current working directory to the file.</p>
<p>If you have a file in a subdirectory of the current working directory, you can
use a relative pathname to access it by giving the direction through the
subdirectories to get to the file. For example, if you want to read in a file
named “bacterial_counts.xlsx” that is in a subdirectory of the current working
directory called “data,” you could point to that file using the relative
pathname “data/bacterial_counts.xlsx.” Instead, if you want to point to a file
with the same name that’s in a subdirectory called “reported_data” of the “data”
subdirectory, you’d use the relative pathname
“data/reported_data/bacterial_counts.xlsx.”</p>
<p>You can use relative pathnames to navigate, too, to files that aren’t in a
subdirectory for the current file. To do this, you can use [abbreviations?]
for filenames. One of the most useful is “.” which stands for the parent
(i.e., one above) the current working directory. For example, if you have
a project directory, and you’ve put an RMarkdown file in the “reports”
subdirectory, but within the code in that file you want to read in data from
the “data” subdirectory of the same project, you could do so with a relative
pathname like “./data/bacterial_counts.xlsx.” This pathname says to move up
one directory from the current working directory (in other words, to the
directory that the current work directory is a subdirectory of) and then
look for a different subdirectory of that parent directory called “data,”
then read a file from that subdirectory.</p>
<p>This strategy is necessary when you’re using RMarkdown for your reports
and have created a project directory template with different subdirectories
for your data versus your reports. In an RMarkdown document, the code will
run using the directory where the RMarkdown file is stored as the working
directory [correct even with Projects?]. Therefore, if you organize your
project directory in the type of structure we’ve recommended, then you’ll
need to use this type of relative pathname to access data elsewhere in
the project directory when you write code for the report.</p>
<p>We can take a look at how this works in the project directory template we
created for the example set of studies. In module [x] we gave details on
what is included in the template report for this project directory template.
Briefly, it is a file that will generate a couple of tables with metadata
on the experiment (overall experiment details as well as details on each
of the treatments), then a graph showing mouse weights over time, then a
graph showing the bacterial load at the end of the study in mice grouped
by treatment, and finally a table giving the results of comparing the
bacterial load in each treatment group to the bacterial load in the control
group.</p>
<p>We created an Rmarkdown file that does this analysis and visualization and
included it in the project template directory. This means that the report file
will be copied and available each time someone copies the project template
directory at the start of a new project. We wrote the code in a way that will
input data that are stored in the data collection files that also come with the
project directory template. Since we named those files in the directory
template, we can refer to them with the same name in the code for the report. We
wrote the code in the report in a way that it will still run if there are more
or fewer observations in any of the data collection files, so the report
template has some flexibility in terms of how each study in the set of studies
might vary. For example, in the example set of studies, some of the experiments
were run using only a control group of mice, while others were run to test as
many as [x] different treatment groups. The report template can accommodate
these differences across studies in the set of studies.</p>
<p>…</p>
<p>In many cases, you may have a more complex design for your project directory. For
example, if you were collecting flow cytometry data for the project as well, then
you would want a subdirectory in the project that is specifically designed to
store files from the flow cytometry component of the experiment. This subdirectory
would likely include several files, rather than just one. Further, you would not
know ahead of time what the name of these files would be (as you do with the data
collection template files that are included in the template directory). However,
you can still easily write code for a template report file that will work with
multiple files of a similar type, even if you don’t know what the names will be,
as long as you know what the name of their subdirectory will be. There are functions
in R like <code>list.files</code> that can be used to list all the file names for the files
in a given directory. You can use this function to create a vector of all the file
names. For example, you could run:</p>
<p>to get an object (<code>flow_filepaths</code>) that lists each of the filepaths for the files
stored in the “flow_data” subdirectory within the “data” subdirectory of the
project. You could then “map” a function or group of functions across these
files to read them in, process them, and join them into a single dataframe in R.
By using this process, you can write template code in the report for the project
that should work in most cases for the data that you collect for a given type of
study.</p>
<p>The report template is included in the project directory template, so it will be
copied and available for you to use anytime you start a new project using that
template. However, you are not obligated to keep the report identical to the template.
Instead, the template report serves as a starting point, and you can add to it or
adapt it as you work on a study.</p>
<p>For example, in our example template report, we’ve included the results of
applying a statistical test that compares each treatment group to the control
group. Instead, for a specific study of this type, you may want to control
treatments against each other. For example, some of the studies in this example
set of studies include a positive control group, where the mice are treated with
a drug that is already in common use for the disease. In some cases, the
researcher may want to control the bacterial load in groups treated with a novel
drug to groups treated with the positive control. You could easy add to the
report template in that case, adding statistical tests where you compare
different treatment groups to each other.</p>
</div>
<div id="creating-an-r-project-template" class="section level3" number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Creating an R Project template</h3>
<p>In the previous section, we covered a very basic way to make a project directory
template: you make an example directory of project files, and then anytime you
start a project for that type of study, you copy, rename, and use that example
directory as a template.</p>
<p>There is a second way to make project templates for your research group. This
method requires a lot more work at the beginning. However, it makes it very easy
for anyone in your group to use the template once it’s been created. This method
is to create an R Studio Project template. To be clear, with the basic method
covered in the last chapter, you can create a project directory based on you
basic template and then convert it to an RStudio Project within RStudio.
However, with this second method, you will gain the option to create a new
project based on your template from within RStudio, and many of the details of
creating the template are encapsulated within the process, so you’re more likely
to be able to enforce a common project directory structure across projects.</p>
<p>This method does require a good bit of familiarity with R programming, as it
requires you to create a new R package. In this section, we’ll go over the
process, using the example set of studies for this module as a motivating
example. …</p>
<p>…</p>
<p>There are several steps that you’ll take to create the RStudio Project
template:</p>
<ol style="list-style-type: decimal">
<li>Decide on project directory structure</li>
<li>Create templates for recording data</li>
<li>Create a template for a report for the project</li>
<li>Create an R package to implement the Project template</li>
<li>Move the templates for data recording and the report into the “inst”
directory of the Project package</li>
<li>Write code in the package to create project structure and copy in templates</li>
<li>Customize the Project Wizard for the Project in the package code</li>
<li>Build the Project template package and share it with your research group</li>
</ol>
<p>Several of these are the same as the steps to create a basic project directory
template. Specifically, steps 1–3 are the same steps that you would take to
create a basic project directory template.</p>
<p>The novel steps for this process come from step 4 and later. Rather than
creating a file directory that your research group will copy and rename, we’ll
put all the elements of the project template within an R package that you can
build and then share with your research group. They will be able to install this
package, and then whenever they start a project, they will be able to initialize
it as this special type of project from within RStudio, as described in the
previous module.</p>
<p>Under this method, the template is put together and shared as an R package. An R
package is a collection of R code and data that extend the functionality of base
R. If you have coded with R, you’ve likely used these types of packages to get
access to useful functions. For example, the “tidyverse” (module [x]) is a suite
of popular R packages with functions for working with data. Anyone can create
and share an R package, either broadly and publicly by submitting it to a
repository like Bioconductor (in which case it will need to follow some
additional constraints and pass some checks) or privately as a compressed file
that anyone you share it with can download to their computer and install.</p>
<p>The new steps in this process start with step 4, which is to create an R package
to implement the Project template. You can create the framework for an R package
very easily in R study. Open RStudio, go to “File,” and select “New Project,” as
you would if you were creating any type of RStudio Project. Choose “New Directory,”
but then instead of choosing the generic “New Project,” choose “R Package.” This
will create an open a new Project directory for you package, one that includes
templates for many of the files that you need to start a new R package. (As a note,
this is using a special R project template, just like you’ll be creating!)</p>
<p>[More on the initial package directory]</p>
<p>…</p>
<p>For most R packages, you create them to use to share new R functions.
Therefore, the package directory is focused on new R scripts. However,
the R package structure is very flexible, and it can be effectively used
to share other things as well. For example, R packages can be created
to share datasets, with very few or no new functions included. Similarly,
the R package that we’ll make with your template will allow you to share
a directory structure and some “starter” files to go into that structure,
rather than R code.</p>
<p>Since we’re using the R package structure for this alternative use, it may
at first seem a bit confusing why we need to put certain files in certain
places or write code that moves files around. Briefly, R packages are
created and shared essentially as file directories, but these file
directories must follow a very specific structure, with specific names
for different subdirectories and files within the structure. We’ll need
to follow these rules as we organize the template files within our R package
for our Project template. We will explain as we move through this section
where you should save everything in your R package directory, but this is
just to clarify that there is a reason that the structure might seem a
bit convoluted—we’re leveraging a structure normally meant for a bit of
a different use.</p>
<p>[Where to put the template files]</p>
<p>You can make as many template files as you’d like to include in your Project
template. When you make the R project with your template, you’ll store these all
in a special directory that you should call “inst.” In an R package, the “inst”
directory can act as a bit of a catch-all, where you can store files that you
would like to be included when someone installs your package, but that don’t
naturally fit in another part of the package directory.</p>
<p>Within this “inst” subdirectory, you can create as many subdirectories as you’d
like, to help you organize your template files. The only rule is that there are
a handful of names that you should avoid for these subdirectory names. This is
because, when the package is installed, all the subdirectories in this “inst”
subdirectory will be moved up to the main package directory, and so you should
avoid directory names that have a specific meaning in an R package. Namely, you
should avoid naming any subdirectories in the “inst” subdirectory any of the
following: “data,” “R,” “src,” “man,” “demo,” “tests,” “exec,” “po,” “tools,”
“vignettes” [?], “build” [?], “share” [?], “licenses” [?].</p>
<p>In the template for the example set of studies for this module, for example, we
created three subdirectories in the “inst” subdirectory to use to store
templates for this type of Project: “data_collection_templates,” where we stored
an Excel file with the template for collecting data during each experiment
(i.e., the mice weights and final bacterial loads), “metadata_templates,” which
includes an Excel file with the template for collecting metadata on the
experiment on a whole and on each of the tested treatments, and
“report_templates,” where we stored an RMarkdown file with the template report
for the project. For any templates that include code, keep in mind that you’ll
need to be careful in setting the pathnames to access any data in the project
directory. [More on this?]</p>
<p>Once you’ve added any templates to the “inst” directory, the next step is to
write code in the template package. For this type of package, which aims to
set up a new Project structure, you’ll only include R code for one purpose—the
R code will run when someone first opens a new Project of this type, and it
will operate to set up the initial project structure. R can be used to do
many different things—while you may have mostly used it before to read in and
analyze data, it can also be used to do things like make new directories on
you computer, or to copy files from one place in your computer’s file directory
to another. We’ll be using these types of commands in this template R package,
as it will allow us to move the template files that you created into the
right place in a user’s new project directory when they chose to use your
template to make a new project.</p>
<p>There are four key R functions that we’ll be using to do these tasks. The first
is the <code>dir.create</code> function. This can be used to create new directories on
the user’s computer. You can include the name that you’d like to use as the
new subdirectory. We’ll use this function to create the subdirectories in the
new project, and so this function will let us create a structure within the
user’s subdirectory.</p>
<p>The second key R function that we’ll use is <code>file.copy</code>. This function allows
us to copy a file from one place in the user’s computer to another spot. When
the user installs our package, all of the template files will be included with
that installation. With <code>file.copy</code>, we’ll be able to copy these template files
into the right spot on each user’s computer each time they open a new Project
with this template.</p>
<p>The third key R function also helps with this process of copying the template
files. In order to copy the files, we need to be able to find where they’re
stored on the user’s computer. Since they’ve been installed with the package,
the template files will be located on the user’s computer based on where that
user stores their installed R packages. This location can differ by user,
but fortunately there’s a function called <code>system.file</code> that lets us figure out
the file path for any file that’s stored in an R package that the user has
installed, on that user’s computer. This function will therefore allow us to
get the original filepath for each of the template files, so we can copy them
into the new Project.</p>
<p>Finally, the fourth key R function is <code>file.path</code>. …</p>
<p>[How to create directories and move in the template files]</p>
<p>[How to customize the Project Wizard for the project]</p>
<p>As you work on the package, you can build it and test it on your own computer.
If you are working in RStudio, you can use a “Build” Pane that is available
when you’re working on a R Project that is a package. In this pane, there
is a “Install and Reload” button [doublecheck]—if you click this button,
it will build the package and install it on your computer in the same
place that other R packages are installed (for example, packages that you
install from CRAN).</p>
<p>Once you’ve built and installed your package, give it a try. You can go
up to the “File” menu in RStudio and select “New Project.” Select
“New Directory,” and this will take you to a menu with the different types
of R Projects you can create. You should now see your Project template
as one of the options. Click on this, and you can test out if the template’s
working like you hoped it would.</p>
<p>[How a different user can download and install a package that isn’t on CRAN]</p>
<p>If you would like to create one of these RStudio Project templates for studies
in your research group, there are more details on the process at … In addition,
since this method requires building an R package, you may find resources on creating
R packages to be useful. One excellent book on the topic, which is available for
free online, is [R Packages] by Hadley Wickham and Jenny Bryan.</p>
</div>
<div id="applied-exercise-1" class="section level3" number="2.8.3">
<h3><span class="header-section-number">2.8.3</span> Applied exercise</h3>

</div>
</div>
<p style="text-align: center;">
<a href="2.7-module7.html"><button class="btn btn-default">Previous</button></a>
<a href="2.9-module9.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
