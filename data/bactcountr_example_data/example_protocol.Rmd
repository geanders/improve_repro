---
title: "Protocol: Estimating bacterial loads from plating samples at different dilutions"
date: "3/1/2021"
output: pdf_document
bibliography: ../../book.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## Overview

This protocol provides details on how you can estimate the bacterial load in
samples based on data from plating those samples at different dilutions. The
question being answered through this protocol of data analysis is: How much
viable (i.e., replicating) bacteria are in each of your samples?

You can find out by **plating** the sample at different **dilutions** and
counting the **colony-forming units (CFUs)** that are cultured on each plate.
You put a sample on a plate with a medium they can grow on and then give them
time to grow. The idea is that individual bacteria from the original sample end
up randomly around the surface of the plate, and any that are viable (able to
reproduce) will form a new colony that, after a while, you'll be able to see.

To count the number of colonies, you need **a "just right" dilution** (likely
won't know what this is until after plating) to have a **countable plate**. If
you have **too high** of a dilution (i.e., one with very few viable bacteria),
randomness will play a big role in the CFU count, and you'll estimate the
original with more variability. If you have **too low** of a dilution (i.e., one
with lots of viable bacteria), it will be difficult to identify separate
colonies, and they may complete for resources. (The pattern you see when the
dilution is too low (i.e., too concentrated with bacteria) is called a
*lawn*---colonies merge together). To translate from diluted concentration to
original concentration, you can then do a back-calculation, incorporating both
the number of colonies counted at that dilution and how dilute the sample was.

> "The most widely used method for determining drug efficacy [for TB] in mice 
remains enumeration of the bacterial load in lungs and spleens, by counting
the colony forming units (CFU) of the organ homogenates on agar plates."
[@franzblau2012comprehensive]

> "Quantitative estimation of the number of viable microorganisms in
bacteriological samples has been a mainstay of the microbiological laboratory
for more than one-hundred years, since Koch first described the technique (Koch,
1883). Serial dilution techniques are routinely used in hospitals, public
health, virology, immunology, microbiology, pharmaceutical industry, and food
protection (American Public Health Association, 2005, Hollinger, 1993, Taswell,
1984, Lin and Stephenson, 1998) for microorganisms that can grow on
bacteriological media and develop into colonies." [@ben2014estimation]

> "The objective of the serial dilution method is to estimate the concentration
(number of colonies, organisms, bacteria, or viruses) of an unknown sample by
counting the number of colonies cultured from serial dilutions of the sample,
and then back track the measured counts to the unknown concentration."
[@ben2014estimation]

> "Generally speaking, the methods which have been employed may be classified
into (1) the direct and (2) the indirect. In the former the organisms are
counted directly under the microscope, in the latter the number of bacteria
present is calculated from an enumeration of the colonies which develop when 
an aliquot part of the emulsion in question is mixed with a nutrient medium
in a Petri dish, and incubated for a variable period of time. The former 
is designed to record the total number of organisms present, the latter only
the number which happens to be viable at the moment of sampling." 
[@wilson1922proportion]

> "The indirect or viable count has, as a rule, been performed by a 
modification of Koch's original plating method. ... The modifications of 
Koch's method have been concerned with the medium used, the question of 
preliminary dilution, the methods of dilution and the exact technique of 
counting the plates. The majority of observers appear to have used agar, 
but [a few] seem to have preferred gelatin, though in some cases both 
media were employed. With regard to preliminary dilution, the earlier
workers generally preferred to plate out the original emulsion, while
of late the tendency has been in the opposite direction ... . The 
method of dilution has been subject to considerable variation; on the 
whole volumetric pipettes have been the most popular, but [some] 
used dropping pipettes, while [others] resorted ot the use of a standard
platinum loop. ... The important question of the counting of the plates
has naturally depended largely on whether or no a preliminary dilution 
of the emulsion was made. Where the number of colonies was very great, 
microscopic counting was adopted ... . Where on the contrary, dilution was
employed, the use of the microscope was no longer necessary, and counting 
was performed with the naked eye or with a magnifying glass ..." 
[@wilson1922proportion]

> "In perusing the results of previous workers, it was striking to 
observe the peculiar lack of attention which was paid to the estimation
of the experimental error involved in the methods employed. Probably this 
is to be attributed to the fact that in many cases in which the enumeration
of bacteria was undertaken, a relative, rather than an absolute accuracy
was essential. It was felt that the successful accomplishment of this
object could only be obtained by working out a technique in which the 
errors inherent in every step should be known with certainty." 
[@wilson1922proportion]

> "The plate count method for estimating bacterial populations is 
satisfactory for many comparative purposes if *relative* rather than 
*absolute* numbers of cells are wanted, although in some cases, because
of clumping, plate counts may not bear a constant relation to total 
counts even during the logarithmic growth phase (Jennison, 1937). 
This lack of agreement may be overcome, at least with some organisms, 
by proper shaking to break up clumps of cells (Ziegler and Halvorson, 
1935)." [@jennison1940evaluation]

> "A dilution assay is an experiment for estimating the concentration 
or frequency of target entities in a sample, in situations in which 
accurate counts of the organism are too difficult or costly to obtain. 
The original sample is divided into subsamples at lower concentrations by 
dilution. These subsamples may be further sampled to obtain replicate
plates, tubes, or wells at each concentration level. Each replicate is then
scored for the presence or absence of the target entity. This determination 
of positivity or negativity of each replicate may require an auxiliary 
test or procedure. For instance, the presence of bacteria may be deduced
from the appearance of colonies after plates have been incubated for a time. ...
The idea of a dilution assay is to choose a sufficiently broad range of 
dilutions that a transistion from positive to negative results is virtually
ensured as one proceeds through the dilution sequence. The dilutions at
which the transition occurse contain information on the concentrations of 
target entities in the original sample. We take estimation of this 
concentration as the primary purpose of the assay."
[@myers1994dilution]

> "The plate count method is based on viable cell counts. The plate count 
method is performed by diluting the original sample in serial dilution 
tubes, followed by the plating of aliquots of the prepared serial dilutions
into appropriate plate count agar plates by the pour plate or spread 
plate technique. The pour plate technique utilizes tempered molton plate
count agar poured into the respective plate and mixed with the diluted
aliquot sample in the plate, whereas the spread plate technique utilizes
the addition and spreading of the diluted aliquot sample on the surface
of the preformed solid plate count agar in the respective plant. ...
These prepared plate count agar plates are then optimally incubated, and the
colonies observed on these plate count agar plates are then counted as 
the number of CFUs. The counting of CFUs assumes that every colony is 
separate and founded by a single viable microbial cell. The total 
colony counts obtained in CFUs from the incubated agar plates and the 
respective dilution factor used can then be combined to calculate the 
original number of microorganisms in the sample in CFUs per mL. The typical 
counting ranges are 20--250 CFUs or 30--300 CFUs per standard plate count
agar plate. Additional considerations for counting CFUs are counting of 
plate spreaders, too numerous to count (TNTC) reporting and statistics, 
rounding and averaging of observed plate counts, limit of detection, and 
limit of quantification of plate countes (77--79). There are also 
optimal condition assumptions for the plate count method as changes to the 
plate count agar nutrient level or temperature can affect the surface growth of 
bacteria (80, 81). Primary equipment and materials used for this method 
are serial dilution tubes (bottles); Petri plates or dishes; pipettes; 
specific growth medium, diluents, and reagents; incubator and water bath
with appropriate optimal temperature setting; commercial colony counter
(manual or automate); and plate spreader or rod. Total bacteria and fungi
can be enumerated separately using the plate count method based on the 
type of culture medium utilized (82--86). Specific or selective culture
medium can also be used in place of the standard plate count agar media
for more specific microbial enumeration (87). Sources of error using this 
method are improper or inadequate preparation of the test samples, 
serial dilution error, suboptimal incubation conditions, undercounting
due to cell aggregation or clumping, and analyst error in the colony
counting or calculation of observed results." [@goldman2015practical]

> "The plate count method is primarily used in the enumeration of 
samples with high microorganism numbers of microorganisms that do not 
grow well in liquid media. Plate count methods are used in the areas of 
food, pharmaceutical, environmental including drinking water applications, 
and biofilm testing. Modified or alternative versions of the plate count
methods have also been developed to further enhance the use of the standard
plate count method approach to estimate bacteria or fungi by utilizing
the roll tube method, drop plate method, spiral plate count method, 
Petrifilm, SimPlate, replicate organism detection and counting (RODAC)
plate for environmental surface sampling, dip slide or dipstick paddle 
method, and adhesive sheet method." [@goldman2015practical]

## Laboratory description

These data result from plating each sample at several different dilutions and
counting the colony-forming units (CFUs) that are cultured on each plate. For
each animal, the spleen was homogenized in phosphate buffer saline (PBS). This
homogenate was plated on 7H11 agar plates at four serial dilutions, from
undiluted to a dilution of $5^{-3}$. The plates were incubated for 3--5 
weeks at $37^{o}C$, and then colony-forming units (CFUs) were counted on each
plate. [?]

Each sample was on a plate with a medium they can grow on and then given [time]
to grow. On each plate, the individual bacteria from the original sample should
have ended up spread randomly around the surface of the plate, and any that are
viable (able to reproduce) formed a colony that, by the end of the procedure,
can be counted.

[Image of plating]

Each sample was taken from a single mouse from the experiment. These mice came
from different experimental groups, with several replicates (mice) per 
experimental group. The experimental groups in this case were: 

[table of experimental groups]

The CFU solution, in each case, was resuspended in 0.5 milliliters [of ...]. 
For each plate, 100 microliters were plated. Half of the spleen was used 
for each sample.

The dilution factor in this experiment is 5 (i.e., a five-fold dilution 
from each dilution level to the next).

[Plating in quarters?]

> [Different type of mycobacteria] "The number of viable mycobacterial cells in
each single-cell suspension was determined by standard plate counting as a
reference method. Briefly, the undiluted stock cell suspension (1.0 ml) was
added to 9.0 ml of 10 mM PBS (pH 7.2). Tenfold serial dilutions were made in 10
mM PBS (pH 7.2), with vortexing between each dilution step. One hundred
microliters from each dilution was plated onto each of three 7H10 agar plates
supplemented with 10% oleic acid-albumin-dextrose-catalase and 2 microgram/ml of
mycobactin J. Colony counts (CFU) were determined after the incubation of plates
at 37 degrees C for 10 weeks. MGIT ParaTB tubes were inoculated in triplicate
with 100 microliter of the same serial dilutions. To evaluate the effect of the
MGIT tube inoculum volume, one set of tubes was inoculated with 100 microliter
and another was inoculated with 1,000 microliters from each of the serial
dilutions of multiple M. paratuberculosis strains." [@shin2007rapid]

> "Mtb is a member of the slow-growing pathogenic mycobacterial species,
characterized by a 12- to 24-hour division rate and prolonged culture period on
agar of up to 21 days. Why Mtb grows so slowly is not well understood. Proposed
mechanisms include limitation of nutrient uptake through the highly impermeable
cell wall and slow rates of RNA synthesis (96). During experimental infections,
its metabolism can shift from an aerobic, carbohydrate-metabolizing mode to one
that is microaerophilic and lipid metabolizing (25). Mycobacteria are
facultative intracellular bacteria that multiply within phagocytic cells,
particularly macrophages and monocytes. Although many mycobacterial species are
environmental, Mtb is strictly parasitic." [@sakamoto2012pathology]

> "For the testing of single compounds as well as short term mouse experiments, 
some investigators mentioned plating whole lungs while others plate the 
homogenate of a single lung lobe from each animal. After long treatment 
regimens when low bacterial numbers are expected, generally the whole lung is
homogenized and a sizeable fraction of up to one-half of the homogenate is plated. 
One group homogenizes whole lungs in a total of 2.5 mL PBS and then plates
the entire homogenate on five 7H11 plates (0.5 mL per plate). Another group
uses whole lungs and total spleen homogenized in 4 mL PBS supplemented with 
0.05% Triton X-100." [@franzblau2012comprehensive]

> "Several issues regarding the endpoints and the mouse models themselves
were discussed. Regarding accurate endpoints in treatment trials, the 
method used for enumerating bacteria from organ homogenates should be 
carefully (re)considered given the possibility that some non-culturable 
bacteria in samples of animal tissues may not form colonies on solid agar. 
Liquid media, such as BACTEC or MGIT, was suggested as a method to enhance
sensitivity for finding low numbers of CFU and to gain some insight into 
the state of the bacillus at the time point examined. Liquid testing using 
the MGIT system is also now the method of choice for sputum evaluation to assess 
culture conversion for clinical trials. Several automated liquid culture
systems have shown greater sensitivity than the traditional solid-media
cultures the acknowledged increased in the mycobacterial recovery rate of 
liquid media, which is likely due to a more mycobacterial populations 
being able to recover in liquid culture than on solid media. This is
supported by in vivo and in vitro observations that subpopulations of 
M. tuberculosis with different states of metabolic activity co-exist in 
old liquid cultures, as well as in liquid cultures with bacterial growth 
from chronic infected mice that do not grow on solid media."
[@franzblau2012comprehensive]

> "Another topic of discussion in at least two laboratories was the issue
of drug carry-over at the time of enumeration of bacterial colonies 
in the organs. CLF and TMC-207 both have long half-lives, high tissue
distribution and tissue binding, and therefore drug might still be present
at the time of sacrificing the animals. The first indication that 
drug carry-over is an issue is observed when dilutions of organ 
homogenates do not have the expected reduction in bacterial number. 
Another indication might also be the lack of correlation between the bacterial
number and the gross pathology observation. Several methods have been described
to reduce the carry-over of drug in agar plates, including using LJ medium
or 7H11 with 5% bovine serum albumin (BSA) for TMC-207, and using 0.4%
activated charcoal for CLF. Relapse studies will then show the true
sterilizing potential of these drugs and drug combinations." [@franzblau2012comprehensive]

> "It was pointed out that colony forming units (CFU) measures by plating
organ homogenates on solid agar are often inaccurate since they do not
necessarity include just single bacilli but rather small clumps or
conglomerations. There was discussion around the hypothesis that these
clusters represent a type of biofilm. Hatfull et al. found these
M. tuberculosis biofilms in vitro to consist of bacteria surrounded by 
a layer of free mycolic acids. Although the biofilm hypothesis was not
accepted by everyone, it was agreed that the extracellular bacteria in these
micro-environments are unique and should be treated by drug treatment. 
Another topic of discussion was about the drug refractory nature of these
persisting bacilli being a drug penetration issue, by drugs not getting through
this fibrous rim and extracellular lipid matrix. The ability to determine
the penetration of TB drugs into a granuloma was seen as an important
gap in the current knowledge about TB drugs." [@franzblau2012comprehensive]

> "The activity of an investigational drug or regimen has been in recent years
mostly determined by the reduction of colony forming units (CFU) of M.
tuberculosis by dilution of organ homogenates on solid agar 7H11 plates. Plating
of the organ homogenates has always been the gold standard for quantifying drug
efficacy in vivo. However, drug discovery efforts are often times held up by
this time consuming step requiring an incubation period of the bacterial plates
of 3--4 weeks. For early drug discovery efforts, more efforts are being
investigated lately for indirect, but more rapid, methods to 'measure' the
bacterial load: such as the luciferase readout or fluorescence. These novel
detection methods will undoubtedly accelerate the TB drug discovery process by
delivering an immediate readout on the efficacy of an experimental compound at
either time of sacrifice (for luciferase readout) and even in liveanimals in
real time (fluorescence). Thorough validation, however, is not available as of
yet and would be required before these indirect methods can replace the
enumeration by CFU for all drug classes." [@franzblau2012comprehensive]

> "Another discussion took place at several occasions during this project,
pointing out that perhaps not all bacteria can be identified, cultured or
visualized by current methods. The discussion started with the recent
introduction of liquid culture media for the diagnostic evaluation of clinical
specimens for suspected tuberculosis. The question then became whether drugs or
regimens which preferentially kill certain bacillary populations would give rise
to a 'flawed' readout by only culturing certain subsets of bacteria on solid
agar. If liquid cultures of organ homogenates allowthe growth of TB
subpopulations that will not grow on solid media, the parallel evaluation in
liquid and in solid cultures might offer an opportunity to study drug effects on
subpopulations in different metabolic states. ... This question might even be
more relevant in animal models with a greater variety in granulomatous lesion
types where bacilli are located in different environments (such as in necrotic,
closed or cavitary lesions) and hence might have different metabolic stages."
[@franzblau2012comprehensive]

## Data description

Data are collected for this process into a spreadsheet that is set up in a
"tidy" format used by our laboratory to collect this type of data. Here are the
first few rows of the data:

```{r echo = FALSE}
library(tidyverse)
cfu_data <- read_csv("cfu_data.csv")
head(cfu_data)
```

Each row represents the number of bacterial colonies counted after plating a
certain sample at a certain dilution. Columns are included with values for the
experimental group of the sample (`group`), the specific ID of the sample within
that experimental group (`replicate`, e.g., `2-A` is mouse A in experimental
group 2), the dilution level for that plating (`dilution`), and the number of
bacterial colonies counted in that sample (`CFUs`).

In cases where the bacteria were too numerous to count, that dilution level
is excluded from the data.

## Reading data into R

The data are stored in a comma-separated plain text file called "cfu_data.csv". 
They can be read into R using the following code: 

```{r}
library(tidyverse)
cfu_data <- read_csv("cfu_data.csv")
head(cfu_data)
```

You will need to be sure that the data file ("cfu_data.csv" in this case) is
in the working directory of your R session. You can check the current working
directory in R with the call `getwd()`, and you can list all files in the 
current working directory with the call `list.files()`. These function calls
can be useful to check to make sure that this file is in your working directory
and, if not, to identify which directory on your computer file system you 
should move it to.

Once you run this command, the data will be available in your R session in the
object `cfu_data`. You can see the first few rows by running: 

```{r}
head(cfu_data)
```

You can get a summary of the data by running: 

```{r}
summary(cfu_data)
```

## Exploring the data and quality checks

It is helpful to explore the data once you read it in, to check for quality
control issues and other characteristics of the data from a particular
experiment. This section provides code examples for this quality control.

First, it can be helpful to ensure that the data includes the number of
experimental groups, and the number of replicates within each group, that
you are expecting. First, we can determine that there are eight experimental 
groups, with between two and three samples (replicates) in each group: 

```{r}
cfu_data %>% 
  group_by(group) %>% 
  summarize(n_replicates = length(unique(replicate)))
```

It is also helpful to see the distribution of CFUs at each dilution level, which 
can be plotted with the following code: 

```{r out.width = "0.8\\textwidth", fig.align = "center"}
cfu_data %>% 
  ggplot(aes(x = CFUs)) + 
  geom_histogram() + 
  facet_wrap(~ dilution)
```
In this case, most bacterial counts are zero at all dilution levels. However, 
there are more non-zero CFUs at dilution level 0 and more as you move to higher
dilution levels. The highest CFU count at any dilution level is a little over
50, for dilution level 1. Most non-zero CFU counts are at or below 30, 
regardless of dilution level.

## Identifying a good dilution for each sample

In this experiment, we plated at dilution levels of 0, 1, 3, and 3, with a
dilution factor of 5. In other words, we have the following dilutions for 
each dilution level: 

| Dilution level  | Dilution at that level |
| ------------- | ------------- |
| 0  | $10^0$  |
| 1  | $10^{-0.5}$  |
| 2  | $10^{-1}$  |
| 3  | $10^{-1.5}$  |

To count the number of colonies, you need a "good" dilution to have a
**countable plate**. You won't be able to pick a "good" dilution for each sample
until you have plated several dilutions and see approximately how many colonies
form on each. This is why a plating experiment will include plates for 
each sample at several dilution levels of the sample.

It is important to use a "good" dilution to estimate the bacterial load
in the original sample, because there are challenges and pitfalls to 
trying to count CFUs if the dilution is too high or too low.

If you try to count for a plate that has too high of a dilution (i.e., the
sample has been diluted a lot, and so has very few viable bacteria), randomness
will play a big role in the CFU count, and you'll estimate bacterial load in the
original sample with more variability than desired. If you have too low of a
dilution (i.e., one that has not been diluted much and has lots of viable
bacteria), it will be difficult to identify separate colonies, and they may
complete for resources. (The pattern you see when the dilution is too low (i.e.,
too concentrated with bacteria) is called a *lawn*---colonies merge together).

Typically, there will be some standard range of CFUs that are indicative of a
plate having a "good" dilution for counting. For example, a laboratory group may
specify that plates with between [x] and [x] CFUs are ideal for counting CFUs,
and so use the dilution for each sample that provides a count in this range when
estimating bacterial load in the original sample. The exact range used to
identify plates with "good" dilutions may range from laboratory group to
laboratory group. It may also depend on the type of bacteria being plated.

In this protocol, we are describing how to analyze data from experiments with
*Mycobacterium tuberculosis*. This is a very slow-growing bacteria
[@pathak2012counting], and so we typically identify "good" dilutions using a
lower range of CFUs than other laboratories might when working with
faster-growing bacteria. The trade-off, of course, is that there will likely be
more variability in our bacterial load estimates, since they tend to be based on
plates with lower average counts. However, we balance this limitation with the
practical limitation of how long it takes for this type of bacteria to grow, and
so need to settle for using lower CFUs in some cases than might be ideal if
working with faster-growing bacteria. 

[Quadrant plating also resulting in a lower ideal count?]

We used the following criteria to pick the best dilution in each sample 
to use to back-calculate the bacterial load in the original sample: 

1. If CFU counts at all dilutions were 0, use the lowest dilution (level 0
dilution); and
2. If some of the dilutions gave non-zero CFU counts, use the dilution with 
a CFU count closest to 25; and
3. If there are ties in terms of which dilution gave a CFU closest to 25, take
the plate with the lowest dilution level of those tied.

Here is the code we used to identify the best dilution level for each sample, 
based on these criteria: 

```{r}
cfu_data <- cfu_data %>% 
  # For each dilution, calculate how far the CFUs counted on the plate are 
  # from 25.
  mutate(diff_from_25 = abs(CFUs - 25)) %>% 
  # For each original sample (ID-ed by the 'replicate' column), determine
  # first if CFUs are 0 at all dilutions and second which dilution 
  # had a CFU count closes to 25. Finally, include a check to see if there
  # are non-zero ties for the sample, in terms of plates with non-zero CFU counts
  # equally close to 25.
  group_by(replicate) %>% 
  mutate(all_zeros = all(CFUs == 0),
         closest_to_25 = dilution[which.min(diff_from_25)], 
         ties_closest_to_25 = sum(diff_from_25 == min(diff_from_25)) > 1)
```

You can check some samples in these data to make sure it's identifying the right
dilution level. First, here is a sample where all CFUs are zero (replicate 3-A).
The code has correctly identified that the CFUs for these samples are all zeros,
marking `TRUE` in the `all_zeros` column.

```{r}
cfu_data %>% 
  filter(replicate == "3-A")
```

Here is an example where some dilutions resulted in non-zero CFU counts, from
replicate 2-B. In this case, there were non-zero CFU counts at dilution levels
1, 2, and 3. The closest to 25 was for dilution level 2, since $\lvert 25-10 \rvert = 15$, which is lower than $\lvert 25-52 \rvert = 27$ or $\lvert 25-5 \rvert = 20$.

```{r}
cfu_data %>% 
  filter(replicate == "2-B")
```

As a quality check, we can see if there are any samples where there were non-zero
ties in terms of which dilution level gave a CFU count closest to 25: 

```{r}
cfu_data %>% 
  filter(ties_closest_to_25 & !all_zeros)
```

These results show that there are no samples where there are non-zero ties in 
terms of which dilutions gave CFU counts closest to 25, so in this case, that
is not a criteria we need to consider further in identifying the best dilution 
level for each sample.

Now that we've identified the best dilution level for each replicate, we can
reduce the data, creating a new dataset with only a single row for each sample. 
Each sample will have a row that provides the best dilution level for that 
sample and the CFU count at that dilution level: 

```{r}
cfu_data_reduced <- cfu_data %>% 
  # Limit to the row with the best dilution for each sample
  filter(dilution == closest_to_25) %>% 
  # Remove the grouping tag applied in the code earlier
  ungroup() %>% 
  # Limit to just the columns of data we need for further steps
  select(group:CFUs)

# Print this reduced data out as a table
cfu_data_reduced %>% 
  knitr::kable()
```

For this experiment, many of the samples had 0 CFUs at all dilution levels. For
the samples with non-zero CFU counts, the best dilutions were often at dilution
level 0 (i.e., undiluted sample), although in a few cases the best dilutions for
samples were at dilution levels of 1 ($10{-0.5}$ dilution) or 2 ($10^{-1}$
dilution). The CFU counts at the best dilution levels were, for non-zero CFU
samples, between 1 and 30. We may want to keep in mind that the sampling error
is likely pretty high for the CFU counts that are lower than about 10 in these
samples.

> "Due to the slow growth rate and pathogenicity of mycobacteria, enumeration by
traditional reference methods like colony counting is notoriously
time-consuming, inconvenient and biohazardous." [@pathak2012counting]

> "Traditionally, quantification of mycobacteria is done by seeding serial
dilutions of bacterial suspensions on suitable media such as Middlebrook 7H10
agar or Lowenstein Jensen followed by counting colony-forming units (CFU).
However, this method is hampered by the long generation time and the tendency of
mycobacteria to aggregate, resulting in multiple founders of a single colony and
an underestimation of the correct number of bacteria. Typically, the time
required for visible colonies to appear on 7H10 agar is 2--3 weeks for M.
tuberculosis and M. a. avium, while it takes about 4--8 weeks for M. a.
paratuberculosis. In addition, plating enough dilutions to make sure the results
can be reliably counted is a tedious task that gives piles of plates with
biohazardous bacteria. A further disadvantage of the colony counting method is
that it cannot be reliably conducted on frozen samples, which may be both more
practical and desirable in several research settings." [@pathak2012counting]

> "Mycobacterium tuberculosis culture, a critical technique for routine diagnosis of tuberculosis, takes more than two weeks." [@ghodbane2014dramatic]

> "A major problem when dealing with tuberculosis has been a difficulty in
diagnosis due to slow growth of mycobacterial cultures, which subsequently
explains the slow process of evaluating the susceptibility of this microorganism
to antibiotics. Using current tools, a primary culture is obtained in two to
four weeks on average and antibiotic susceptibility is determined after an
additional two to four weeks. Therefore, four to eight weeks are needed to
obtain an isolate and determine its susceptibility to antibiotics."
[@ghodbane2014dramatic]

> "Quantification of viable bacteria is a crucial foundation for many types of
research. This seemingly simple task can be challenging, expensive, and
imprecise for Mycobacterium paratuberculosis, a slowly growing organism (>24-h
generation time) with a strong tendency to form large clumps. Studies of
environmental survival, resistance to pasteurization or disinfectants, and
quantification of the pathogen in milk and feces from infected animals are just
a few examples that require precise and sensitive quantification of viable M.
paratuberculosis cells." [@shin2007rapid]

> "The importance of serial dilution and colony counting is reflected by the
number of standard operating procedures and regulatory guidelines describing
this methodology. In all of these guidelines the optimal number ($\hat{n_j}$) of
colonies to be counted has been reported (Park and Williams, 1905, Wilson, 1922,
Jennison and Wadsworth, 1940, Tomasiewicz et al., 1980, FDA, 2001, Goldman and
Green, 2008) as 40--400, 200--400, 100--400, 25--250, 30--300. It is interesting
to note that these references do not specify the area in which the colonies
grow, nor the diameter of the particular organism assayed. The result is that
titration and counting colonies is done within a range that may be inadequate,
and may introduce considerable error." [@ben2014estimation]

> "The main challenge in serial dilution experiments is the estimation of the
undiluted microorganisms counts $n_0$ from the measured $\hat{n_j}$. There are
two competing processes (Tomasiewicz et al., 1980) that affect the accuracy of
the estimation: sampling errors and counting errors. Sampling errors are caused
by the statistical fluctuations of the population. For example, when sampling an
average of 100 colonies, the fluctuations in the number of the population are
expected to be $\pm \sqrt{100}$ when the sampling process is governed by a
Poisson probability (Poisson and Binomial distributions are often used in
statistical analysis to describe the dilution process (Hedges, 2002, Myers et
al., 1994)) where the standard deviation equals square-root of the mean; the
relative error (ratio of the standard deviation to the mean) is $\sqrt{100} /
100 = 0.1$. Thus, the larger the sample size is, the smaller the relative
sampling error; hence, one would like to use a dilution plate with the largest
number  (i.e., the least diluted sample, $j \rightarrow 1$). However, as the
number of colonies increases, counting error is introduced due to the high
probability of two (or more) colonies to merge (due to overcrowding) and become
indistinguishable, and be erroneously counted as one colony. An optimum (a
'sweet spot') between these two processes (sampling and counting error) needs to
be found for using the optimal dilution  (i.e., the optimal jth plate) with
which to estimate $n_0$. Cells can grow into colonies in various ways. Wilson
(1922) states that when two cells are placed very close together only one cell
will develop, and when two cells are situated at a distance from each other both
cells may grow and then fuse into one colony. Either way, the end result is the
appearance of one colony which causes counting error." [@ben2014estimation]

> "It is clear that if three tubes are put up from an emulsion containing a
comparatively small number of bacilli, the chances of obtaining a representative
sample must be smaller than if an emulsion be employed which contains a much
larger number of bacilli. Similarly with the tubes themselves. If only a few
bacilli are introduced, the chances of obtaining a correct idea of the exact
number are smaller than if a large number of bacilli are introduced. Thus the
greater the number of colonies per tube, the less is the error of sampling. That
this is not a mere theoretical consideration is shown from an examination of the
data accumulated during the progress of this work... the percentage deviation of
each individual tube from the arithmetic mean was considerably greater in the
case when a small number of colonies developed than in the case when a large
number of bacilli were inoculated. In other words the sampling error in the
former instance was large, in the latter comparatively small."
[@ben2014estimation]

> "We now come to consider the second factor determining the optimum number
of bacilli to be inoculated in putting up viable counts by the tube method, 
namely the error of overcrowding. More or less in proporation as the error 
of sampling decreases as the number of developing colonies increases, so the
error of overcrowding increases as the number of developing colonies increases.
The two vary in opposite directions; the greater the number of colonies the 
less the sampling error; the fewer the number of colonies, the less is the 
overcrowding error. A point must be chosen between the two which will permit
of the minimum combined error experienced. Before this could be done, however, 
it was necessary to ascertain the actual effect of overcrowding on the 
development of colonies in tube preparations. As mentioned above, this 
overcrowding error is one which seems to have been neglected by the 
majority of observers, or at any rate, not clearly recognized. It is obvious
that the greater the number of bacilli distributed in a given space, the less
is the interval between each of them, and the greater the chance of two 
being coincident. In every case in which two bacilli are coincident or are
placed very close together only one colony will develop. Further, when two 
bacilli are situated at such a distance from each other that each is able 
to develop, yet at such a distance that continued development of both 
will result in fusion, it is clear that a simple colony must arise. Whether
one continues to grow and the other desists or whether both develop, the 
result is the same---namely, the appearance of one colony in place of two 
bacilli. On pure a priori grounds one would expect this overcrowding factor 
to be of considerable importance in determining the number of colonies which
will develop in a given space. One would expect it to play but a small part
so long as comparatively few bacilli were inoculated, but as the number
of the latter increased so should the percentage which fails to develop into
colonies become greater." [@ben2014estimation]

> "Considering the plating method per se, the total error of the mean plate
count of a given dilution of cells is chiefly made up of two rather 
distinct sources of deviations: (a) the distribution or sampling error, 
sometimes inaccurately called the counting error, (i.e., variation in 
number of colonies, due to sampling, between replicate plates of the 
given dilution), and (b), the dilution error, (i.e., the errors of 
pipetting involved in reaching the given dilution). ... It is customary 
to measure the reliability of the plate count by calculating only the
distribution error, and assuming that the dilution error is small, constant, 
and unimportant. We shall show, however, that at best this dilution error 
is of about the same order of magnitude as the distribution error, and 
is, therefore, equally deserving of consideration in arriving at the total
error of plate counts. Furthermore, the dilution error increases with higher
dilutions, whereas the distribution error does not. Obviously, one must take into
account both sources of variation in evaluating the total error, as, for example,
in a problem involving significance of differences, in which the same
dilution might be employed." [@jennison1940evaluation]

> "The size of the distribution error depends upon the number of replicate
plates counted, within limits, other conditions being the same. To obtain 
a small distribution error, a dilution giving the proper number of colonies
per plate (100--400) for enumeration must be available, in order to 
minimise errors of overcrowding and sampling (Wilson, 1922), and a 
sufficient number of replicate plates (3--5) to give a precise mean must be
used (Wilson and Kullman, 1931)." [@jennison1940evaluation]

> "So far as evaluating the distribution error is concerned, this is usually
done by calculating the standard deviation of the mean (standard error) 
of the replicate plates, assuming that the variation between such plates 
is that of random samples. Under good experimental conditions, this 
coefficient of variation will average $\pm$ 4--5 per cent (Jennison, 1937).
In order to test whether observed variations between replicate plates 
are due to chance or to technique, the $\chi^2$ ('chi square') test may 
be used (Wilson and Kullmann, 1931). The calculated value of $\chi^2$ will 
be distributed in a known manner if the replicate samples are from a 
Poisson series, that is, if their variation is that of random samples from 
the same population. Fisher, Thornton, and MacKenize (1922), and Fisher (1938),
have shown that a Poisson distribution is obtained in parallel plate counts
made under standardized experimental conditions. Both the $\chi^2$ test
and colculation of the standard error of replicate plates apply only to 
a given dilution; they do not account for errors involved in arriving at that
dilution." [@jennison1940evaluation]

> "The size of the dilution error will depend upon errors in volume of dilution
blanks, the variation in delivery of pipettes, and upon the number of 
dilutions made. We shall assume that dilutions are made in powers of 10, 
using 9 mL and 99 mL dilution blanks and 1 mL pipettes. With the same
percentage error in 99 mL and 9 mL blanks it is, of course, better to use
the former in preference to the latter, since fewer are required to reach 
a given dilution. The average error in volume of blanks, and in delivery of 
pipettes under experimental conditions must be known." [@jennison1940evaluation]

> "Almost every textbook, laboratory manual and methods volume in 
microbiology contains the statement that plates for counting bacteria should
contain, when possible 30--300 colonies. The '30--300' concept has been 
so ingrained in our thinking that the limits are rarely questioned. ...
The '30--300' concept originated with two publications by Breed and 
Dotterrer (7,8); the text and tables presented in both publications are 
identical. The authors summarized results of a few early studies and 
then proceeded to more clearly define the problem and provide a solution."
[@tomasiewicz1980most]

> "Plates with over 500 colonies under-estimate the true count owing to the
overcrowding error. With careful workers the actual error of counting probably
does not become appreciable till there are about 300 colonies per plate, and for
some distance above this limit it will probably be counterbalanced by the
diminished sampling error. If many places, however, have to be counted, the
fatigue error, which seems to be mainly responsible for the failure of the
sampling error to decrease with increasing numbers of colonies in accordance
with theoretical expectations, becomes appreciable."
[@wilson1935bacteriological]

> "For automated equipment (10), the optiumum counting range may well vary with 
the instrument, particle (colony) size limits, range of colony sizes, etc.
Furthermore, even if automation is not used, appropriate numbers of colonies
that should be on a countable plate can vary widely, depending on many other
variables. With soil fungi, for example, maxima of from 25-100 colonies per 
plate have been suggested (17). Coliform analyses demand another range (24)."
[@tomasiewicz1980most]


## Estimating bacterial load for each sample

As a reminder, here are some of the experimental parameters used in this
experimental that will be needed to back-calculate estimates of bacterial load
in the original samples:

| Experimental parameter  | Value in this experiment |
| ------------- | ------------- |
| Dilution factor  | $0.5$  |
| Volume used to resuspend CFU solution  | $0.5$ $mL$  |
| Volume plated  | $100$ $\mu L$  |
| Proportion of organ used in sample | $0.5$ |

We can load these parameter values into R so they're available in 
the following calculations: 

```{r}
dilution_factor <- 0.5      # So a dilution level of 2 corresponds to a 10^-1 dilution
volume_resuspend <- 0.5     # in milliliters
volume_plated <- 100        # in microliters
prop_organ_in_sample <- 0.5 # Half the spleen was included in the sample
```

First, we can calculate the actual dilution for each sample by taking the 
dilution factor and raising it to the power of the dilution level. For example, 
the dilution at level 2 should be $0.5^2 = 0.25$, while the dilution at level 0
(undiluted) should be $0.5^0 = 1$). 

```{r}
cfu_data_reduced <- cfu_data_reduced %>% 
  mutate(dilution_value = dilution_factor^dilution)

cfu_data_reduced
```

[bacterial load per mL]

Next, we calculated the bacterial load in the original sample. To do this, we
multiplied the dilution value, calculated in the previous step, by the CFU count
at that dilution, as well as by the resuspension volume and divided by the
volume plated, adding a multiplicative factor of 1000 to account for the
difference in units between those experimental parameters (milliliters and
microliters, respectively):

```{r}
cfu_data_reduced <- cfu_data_reduced %>% 
  mutate(bact_load_in_sample = CFUs * 
           dilution_value * volume_resuspend * 1000 / 
           volume_plated)
cfu_data_reduced
```

Finally, to get an estimate of the bacterial load in the full organ, we can 
back-calculate based on the proportion of the organ that was included in the
original sample. In this experiment, we used half of the spleen, so the 
estimated bacterial load in the full organ should be approximately twice
that estimated in the sample (since $1/0.5 = 2$). We calculated this in R: 

```{r}
cfu_data_reduced <- cfu_data_reduced %>% 
  mutate(bact_load_in_organ = bact_load_in_sample * 
           (1 / prop_organ_in_sample))
cfu_data_reduced
```

We have also included a column with log(CFUs), since these are often used in
further data analysis for this type of experiment. This is because ... . We used
$log_{10}$, to be consistent with conventions in the field (the default `log`
function in R takes the natural log, so this required using the `log10`
function).

```{r}
cfu_data_reduced <- cfu_data_reduced %>% 
  mutate(log_cfus_in_organ = log10(bact_load_in_organ))

cfu_data_reduced
```

> "Given an unknown sample which contains $n_0$ colony forming units (CFUs), a
series of $J$ dilutions are made sequentially each with a dilution factor
$\alpha$. From each of the J dilutions a fraction $\alpha_p^{-1}$ is taken and
spread (plated) on an agar plate (assay) where colonies are counted. Thus, in
general there are two dilution factors: $\alpha$ and $\alpha_p$. For example,
$\alpha = 10$ indicates a 10-fold dilution, e.g., by diluting successively 0.1
ml of sample into 0.9 ml of media; and $\alpha_p = 1$ means that the entire
volume is spread (plated) on the agar plate. For an experiment with a larger
dilution factor $\alpha_p$, multiple plates may be spread at the same dilution
stage. For example, $\alpha_p = 20$ represent a 5% plating of the dilution, and
thus up to 20 replicates could be created. At each dilution the true number of
colonies is $n_j = n_0 \alpha^{-j} \alpha_p^{-1}$ and the estimated number is
$\hat{n_j}$. The estimated quantities are denoted with a 'hat' (estimated
quantities can be measured quantities, or quantities that are derived from
measured or sampled quantities); symbols without a 'hat' denote true quantities
(also known as population values in statistics) that do not contain any sampling
or measurement error. In this work both $n_j$ and $n_0$ are 'counts', i.e.,
number of colonies. Knowing the aliquot volume, one can easily convert counts to
concentration (for example CFU/ml)." [@ben2014estimation]

> "A simple method to estimate the number of colonies $n_0$ in the unknown
sample from the counted number of colonies  at the jth assay is presented. Our
method is easy to implement. The method selects the optimal count (i.e., a best
single plate) with which $n_0$ is estimated. There are only a few inputs needed:
the incubation plate size, the microbial colony size, and the dilution factors
($\alpha$ and $\alpha_p$)." [@ben2014estimation]

Some of the colony-forming units may have resulted from more than one bacterial
cell (e.g., a clump of bacteria) being plated at that spot on the plate.

This technique tends to be more suitable for estimating the relative size of 
bacterial loads, for example, to compare across several samples, rather than 
the absolute bacterial load in a sample. 

## Final output

This protocol describes the pre-processing of data collected through a serial
dilution viable plate count for each sample from our experiment. Our input
was the CFUs counted for each plate at each of four dilution levels. Our output
is an estimate of the bacterial load in the spleen from each sample in the 
experiment. 

Our final data includes a row for each of the samples in the experiment---in
this case, each sample represents one animal, and there were several [two or
more?] animals (replicates) for each of [x] experimental groups. For each 
sample, our final data provides a single CFU estimate, representing our 
best estimate of the bacterial load in the whole spleen of that animal. 


> "All respondents [from labs working on tuberculosis] use statistical 
methods in conjunction with their animal trials and most do not consult with
a statistician. Treatment effects are mostly analyzed by a one-way ANOVA, 
followed by a T-test, Tukey or Dunnett's test. For relapse studies a 
Fisher Exact or Chi-square test is applied to compare relapse proportions
between groups." [@franzblau2012comprehensive]

> "Statistical methods are of key importance and different methods are used
depending on the question asked. Methods used were found to be very similar
across laboratories, and often assistance of a statistician was provided to 
answer new questions. Power analysis prior to the experiments is required
to determine the number of animals used in the experiment. The primary data
analysis for mouse models is usually a one-way analysis of variance (ANOVA)
of the log-10 CF bacterial loads, with t-distribution based contrasts 
comparing individual treatments. A Dunnett's test is an appropriate method
for comparing all new compounds to untreated controls, while controlling the
overall error rate in that set of ccomparisons is set at the usual 0.05
level. Also Bonferroni and Tukey statistical tests are appropriate tests for
a pairwise comparison between treatment groups. Evidence of differential 
relapse based on detection (yes/no) of TB bacteria would be established using
a Fisher's exact test comparing rates of relapse between two experimental
groups. In experiments with n = 5--10 per group, power to identify 
significantly different relapse rates is very low. Therefore in order to 
increase the statistical power, more treatment groups are implemented
with various lengths of treatment, or a higher relapse rate is aimed
for in order to see significant differences between different treatment 
regimens. Relapse information obtained from mouse models should always be
interpreted with great care and seen as trends in relapse differences between
treatments." [@franzblau2012comprehensive]

## References